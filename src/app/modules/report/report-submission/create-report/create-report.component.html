<div class="card-form">
    <div class="clearfix">
      <div class="left-nav-bar pull-left row-header">
        <div>
          <img alt="back" class="img-fluid" src="./../../../../../../assets/images/home/Mask_Group_18824.png" (click)="previous()">
          <span class="title">{{'label.organization.reportCreation' | translate}}</span>
        </div>
      </div>
      <div class="right-nav-bar pull-right left-option">
          <ul class="header-right sys-ul space-line">
              <li>
                <button class="btn btn-sm vt-btn mt-btn ng-star-inserted" type="button" (click)="previous()" [innerHTML]="'common.button.previous.icon' | translate">
                </button>
              </li>
              <li *ngIf="!viewMode && isImportRequired && checkChangeFileImport ">
                  <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" (click)="checkImportFile()" [innerHTML]="'common.button.icon.check' | translate">
                  </button>
              </li>
              <li *ngIf="!viewMode && checkShowButtonExport">
                  <button type="submit" class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted"
                          [innerHTML]="'common.button.icon.exportFileReport' | translate" (click)="exportFileReport()"></button>
              </li>
              <li *ngIf="!viewMode && ( !isImportRequired || (checkShowButtonExport && isImportRequired))">
                <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" (click)="save()" [innerHTML]="'common.button.icon.save' | translate">
                </button>
              </li>
              <li *ngIf="!viewMode && ( !isImportRequired || (checkShowButtonExport && isImportRequired))">
                <button type="button" class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" (click)="saveAndSubmit()"
                    [innerHTML]="btnLabelCode | translate"></button>
              </li>
              <li *ngIf="hasPermissionApprove && status == 'CHO_XET_DUYET'">
                <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" (click)="approveReport()" [innerHTML]="'common.button.icon.approve' | translate">
                </button>
              </li>
              <li *ngIf="hasPermissionApprove && status == 'CHO_XET_DUYET'">
                <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" (click)="rejectReport()" [innerHTML]="'common.button.icon.reject' | translate">
                </button>
              </li>
              <li *ngIf="viewMode">
                <button class="btn btn-sm vt-btn btn-submit mt-btn btn-header-right ng-star-inserted" type="button" (click)="navigate()" [innerHTML]="'common.button.icon.edit' | translate">
                </button>
              </li>
          </ul>
      </div>
    </div>
</div>
<div class="info">
    <div class="panel panel-default card-info">
        <div class="panel-heading">
            <strong>
                <span class="ml-2 title-info">Thông tin báo cáo</span>
            </strong>
        </div>
        <div *ngIf="!isMobileScreen" class="panel-body padding-xl ui-g">
    <!--        row 1-->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'label.resolutionsMonth.name' | translate}}</label>
                <div class="ui-g-12 ui-md-9 ui-lg-8">
                    <input [(ngModel)]="submissionInfo.title" [readonly]="true" class="form-control">
                </div>
            </div>
    <!--        row 2 -->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'label.reportConfig.businessType' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <input [(ngModel)]="submissionInfo.nameBusinessType" [readonly]="true" class="form-control">
                </div>
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'lable.report.period' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <input [(ngModel)]="submissionInfo.reportingPeriod" [readonly]="true" class="form-control">
                </div>
            </div>
    <!--        row 3-->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'label.org.submitReport' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <input [(ngModel)]="submissionInfo.orgSubmission" [readonly]="true" class="form-control">
                </div>
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'label.import.template' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <input [(ngModel)]="submissionInfo.nameAdReportTemplate" [readonly]="true" class="form-control">
                </div>
            </div>
    <!--        row 4-->
            <div class="ui-g-12 vt-row">
                <label *ngIf="hasTemplate" class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right required">
                    {{'common.label.fileSign' | translate}}
                </label>
                <div *ngIf="hasTemplate" class="ui-g-12 ui-md-3 ui-lg-3">
                    <multi-file-chooser
                            fileName="submitFile"
                            [disabled]="viewMode"
                            [validMaxSize]="50"
                            [moveFile] = "checkShowMoveFile"
                            [property]="formSubmit.controls.submitFile"
                            validType="pdf,vpdf"
                    ></multi-file-chooser>
                </div>
                <label *ngIf="!hasTemplate" class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right required">
                    {{'common.label.fileSign' | translate}}
                </label>
                <div *ngIf="!hasTemplate" class="ui-g-12 ui-md-3 ui-lg-3">
                    <multi-file-chooser
                            fileName="submitFile"
                            [disabled]="viewMode"
                            [validMaxSize]="50"
                            [moveFile] = "checkShowMoveFile"
                            [property]="formSubmit.controls.submitFile"
                            validType="pdf,vpdf,xls,xlsx,doc,docx,rar,zip,7z,png,jpg,gif,tiff,bmp" >
                    </multi-file-chooser>
                </div>
            </div>
    <!--        row 5-->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'common.label.attachmentFileAppendix' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <multi-file-chooser
                            fileName="appendixFile"
                            [disabled]="viewMode"
                            [property]="formSubmit.controls.appendixFile"
                            [validMaxSize]="50"
                            [moveFile] = "checkShowMoveFile"
                            validType="pdf,vpdf">
                    </multi-file-chooser>
                </div>
            </div>
    <!--        row 6-->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
                    {{'label.armyProposedTemplate.templateFile' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <multi-file-chooser
                            fileName="templateFile"
                            [disabled]="viewMode"
                            [property]="formSubmit.controls.templateFile"
                            [validMaxSize]="50"
                            [moveFile] = "checkShowMoveFile"
                            validType="pdf,vpdf,xls,xlsx,doc,docx,rar,zip,7z,png,jpg,gif,tiff,bmp">
                    </multi-file-chooser>
                </div>
            </div>
    <!--        row 7-->
            <div class="ui-g-12 vt-row">
                <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right required">
                    {{'common.label.importFile' | translate}}
                </label>
                <div class="ui-g-12 ui-md-3 ui-lg-3">
                    <file-chooser [disabled]="viewMode" [property]="formSubmit.controls.importFile" (click)="checkFileImport()" (onFileChange)="changeFileImport()"></file-chooser>
                </div>
            </div>
    
            <div *ngFor="let criteria of reportingCriteria" class="ui-g-8 ui-g-offset-2">
                <label class="ui-g-12 ui-md-3  control-label vt-align-left">
                    {{criteria.criterialName}}</label>
                <div class="ui-g-12 ui-md-3">
                    <input *ngIf="criteria.typeOfData!='textarea'" [readOnly]="viewMode" [type]="criteria.typeOfData=='number' ? 'number': 'text'"
                        [formControl]="formSubmit.controls[criteria.requestReportingCriteriaId]" class="form-control">
                    <textarea *ngIf="criteria.typeOfData=='textarea'" [readOnly]="viewMode"
                        [formControl]="formSubmit.controls[criteria.requestReportingCriteriaId]"
                        class="form-control"></textarea>
                </div>
            </div>
        </div>
        <div *ngIf="isMobileScreen" class="panel-body padding-xl ui-g">
            <!--        row 1-->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'label.resolutionsMonth.name' | translate}}</label>
                        <div class="ui-g-12 ui-md-9 ui-sm-9 ui-lg-8">
                            <input [(ngModel)]="submissionInfo.title" [readonly]="true" class="form-control">
                        </div>
                    </div>
            <!--        row 2 -->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'label.reportConfig.businessType' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <input [(ngModel)]="submissionInfo.nameBusinessType" [readonly]="true" class="form-control">
                        </div>
                    </div>
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'lable.report.period' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <input [(ngModel)]="submissionInfo.reportingPeriod" [readonly]="true" class="form-control">
                        </div>
                    </div>
            <!--        row 3-->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'label.org.submitReport' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <input [(ngModel)]="submissionInfo.orgSubmission" [readonly]="true" class="form-control">
                        </div>
                    </div>
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'label.import.template' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <input [(ngModel)]="submissionInfo.nameAdReportTemplate" [readonly]="true" class="form-control">
                        </div>
                    </div>
            <!--        row 4-->
                    <div class="ui-g-12 vt-row">
                        <label *ngIf="hasTemplate" class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right required">
                            {{'common.label.fileSign' | translate}}
                        </label>
                        <div *ngIf="hasTemplate" class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <multi-file-chooser
                                    class="attachment-file"
                                    fileName="submitFile"
                                    [disabled]="viewMode"
                                    [validMaxSize]="50"
                                    [moveFile] = "checkShowMoveFile"
                                    [property]="formSubmit.controls.submitFile"
                                    validType="pdf,vpdf"
                            ></multi-file-chooser>
                        </div>
                    </div>
                    <div class="ui-g-12 vt-row">
                        <label *ngIf="!hasTemplate" class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right required">
                            {{'common.label.fileSign' | translate}}
                        </label>
                        <div *ngIf="!hasTemplate" class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <multi-file-chooser
                                    class="attachment-file"
                                    fileName="submitFile"
                                    [disabled]="viewMode"
                                    [validMaxSize]="50"
                                    [moveFile] = "checkShowMoveFile"
                                    [property]="formSubmit.controls.submitFile"
                                    validType="pdf,vpdf,xls,xlsx,doc,docx,rar,zip,7z,png,jpg,gif,tiff,bmp" >
                            </multi-file-chooser>
                        </div>
                    </div>
            <!--        row 5-->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'common.label.attachmentFileAppendix' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <multi-file-chooser
                                    class="attachment-file"
                                    fileName="appendixFile"
                                    [disabled]="viewMode"
                                    [property]="formSubmit.controls.appendixFile"
                                    [validMaxSize]="50"
                                    [moveFile] = "checkShowMoveFile"
                                    validType="pdf,vpdf">
                            </multi-file-chooser>
                        </div>
                    </div>
            <!--        row 6-->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right">
                            {{'label.armyProposedTemplate.templateFile' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <multi-file-chooser
                                    class="attachment-file"
                                    fileName="templateFile"
                                    [disabled]="viewMode"
                                    [property]="formSubmit.controls.templateFile"
                                    [validMaxSize]="50"
                                    [moveFile] = "checkShowMoveFile"
                                    validType="pdf,vpdf,xls,xlsx,doc,docx,rar,zip,7z,png,jpg,gif,tiff,bmp">
                            </multi-file-chooser>
                        </div>
                    </div>
            <!--        row 7-->
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3 ui-lg-2 control-label vt-align-right required">
                            {{'common.label.importFile' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9 ui-lg-3">
                            <file-chooser [disabled]="viewMode" [property]="formSubmit.controls.importFile"></file-chooser>
                        </div>
                    </div>
            
                    <div *ngFor="let criteria of reportingCriteria" class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-3 ui-sm-3  control-label vt-align-left">
                            {{criteria.criterialName}}</label>
                        <div class="ui-g-12 ui-md-3 ui-sm-9">
                            <input *ngIf="criteria.typeOfData!='textarea'" [readOnly]="viewMode" [type]="criteria.typeOfData=='number' ? 'number': 'text'"
                                [formControl]="formSubmit.controls[criteria.requestReportingCriteriaId]" class="form-control">
                            <textarea *ngIf="criteria.typeOfData=='textarea'" [readOnly]="viewMode"
                                [formControl]="formSubmit.controls[criteria.requestReportingCriteriaId]"
                                class="form-control"></textarea>
                        </div>
                    </div>
        </div>
        <div *ngIf="dataError">
            <import-error [data]="dataError"></import-error>
        </div>
        <div *ngIf="checkIsHasTemplate && !checkIsManySheet && isImportRequired" id="listArea">
            <div class="panel panel-default">
                <div class="panel-heading vt-relative">
                    <strong>
                        <span class="ml-2 title-info">{{'label.reportSubmission.lstData' | translate}}</span>
                    </strong>
                </div>
                <div id="header-search" style="margin-top: 0.75rem; margin-right: 0.75rem; display: flex; justify-content: flex-end;">
                    <div class="vt-relative">
                        <form [formGroup]="formSearchDataImport">
                            <div class="display-table" style="border: 1px solid rgba(246,183,109,0.6); border-radius: 8px; overflow: hidden;">
                                <div class="table-cell">
                                    <button type="submit" class="icon-search input-search" (click)="filterDataTable()">
                                        <i class="fa fa-search" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="table-cell">
                                    <input type="text" class="form-control input-search no-between-border" name="keyword"
                                           formControlName="keyword" placeholder="{{'home.search.placeHolder' | translate}}"
                                           appendTo="body">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="panel-body panel-table" style="padding: 10px;">
                    <p-table
                            #ptable
                            [scrollable]="true"
                            [value]="lstData.controls"
                            [paginator]="true"
                            (onLazyLoad)="processSearchImport($event)"
                            [totalRecords]="resultList.recordsTotal"
                            [lazy]="true"
                            styleClass="controlOverflow"
                            tableStyleClass="table controls-table table-wrapper b-t b-b"
                            [lazyLoadOnInit]="false"
                            [rows]="changeRow"
                            tableStyleClass="table table-wrapper table-hover table-striped b-t b-b"
                            [resizableColumns]="true"
                            styleClass="controlOverflow">
                        <ng-template pTemplate="colgroup">
                            <colgroup>
                                <col style="width: 50px;">
                                <col style="width: 100px;" *ngFor="let col of listHeader">
                            </colgroup>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th pResizableColumn>STT</th>
                                <th *ngFor="let col of listHeader" pResizableColumn>
                                    {{col.header}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-item let-index="rowIndex">
                            <tr [formGroup]="item" *ngIf="listBody.length>0">
                                <!-- STT-->
                                <td class="vt-align-center">
                                    {{index+1}}
                                </td>
                                <td class="vt-align-center" *ngFor="let col of listBody">
                                    {{processShowValue(col, item)}}
                                </td>
                            </tr>
                            <tr *ngIf="listBody.length == 0">
                                <td class="emptymessage" [attr.colspan]=count [innerHTML]="'app.noRecords' | translate">
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr class="emptymessage">
                                <td [attr.colspan]=count [innerHTML]="'app.noRecords' | translate">
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="paginatorleft">
                            <table-footer (changeRow)="onTablePageChange($event)" [resultList]="resultList"></table-footer>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>
    </div>
</div>
