<div *ngIf="hasPermission('action.view')">
  <div class="panel panel-default">
      <form id="formSearch" [formGroup]="formSearch">
          <div class="panel-heading">
              <strong>
                  <span translate> common.label.search.info</span>
              </strong>
          </div>
          <div class="panel-body padding-xl ui-g vt-border-side">
            <div class="ui-g-12 vt-row">
              <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
                {{'privateStandard.standardType' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <select-filter
                  [placeHolder]="'common.label.cboSelectAll'"
                  [property]="f['standardType']"
                  [options]="standardTypeList"
                  optionLabel="name"
                  optionValue="categoryId"
                  autofocus="autofocus"
                  >
                </select-filter>
                <app-control-messages [control]="f['standardType']"></app-control-messages>
              </div>
              <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
                {{'app.settings.category.generalname' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <input type="text" class="form-control" formControlName="name" maxlength="200" [autoFocus]="true">
                <app-control-messages [control]="f['name']"></app-control-messages>
              </div>
            </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'generalStandard.effectiveFromDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker
                [property]="f['effectiveDate']">
              </date-picker>
              <app-control-messages [control]="f['effectiveDate']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'generalStandard.effectiveToDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker
                [property]="f['effectiveToDate']">
              </date-picker>
              <app-control-messages [control]="f['effectiveToDate']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'generalStandard.expiredFromDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker
                [property]="f['expiredDate']">
              </date-picker>
              <app-control-messages [control]="f['expiredDate']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'generalStandard.expiredToDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker
                [property]="f['expiredToDate']">
              </date-picker>
              <app-control-messages [control]="f['expiredToDate']"></app-control-messages>
            </div>
          </div>
        </div>
          <div class="panel-footer vt-area-button">
            <input type="hidden" name="groupPositionId" />
            <button type="submit" *ngIf="hasPermission('action.view')" (click)="processSearch();" class="btn btn-sm btn-submit" [innerHTML]="'common.button.icon.search' | translate" id="searchCategory"></button>
          </div>
      </form>
  </div>

  <div class="panel panel-default" id="sysCatTable">
    <div class="panel-heading vt-relative">
      <strong>
        <span translate> app.settings.category.standardGroupPostionList</span>
      </strong>
      <div class="show-btn-right-header">
        <button type="button"  (click)="prepareSaveOrUpdate()" *ngIf="hasPermission('action.insert')" class="btn btn-sm vt-btn btn-submit" [innerHTML]="'common.button.icon.addNew' | translate" id="addSysCat"></button>
      </div>
    </div>
    <div class="panel-body panel-table">
      <p-table 
        #ptable 
        [value]="resultList.data"
        [paginator]="true" 
        [paginator]="resultList.data && resultList.data.length" 
        (onLazyLoad)="processSearch($event)"
        [lazy]="true" 
        [rows]="changeRow"
        [totalRecords]="resultList.recordsTotal" 
        [responsive]="true" 
        [lazyLoadOnInit]="false"
        tableStyleClass="table table-wrapper table-hover table-striped b-t b-b" 
        [scrollable]="true"
        [resizableColumns]="true"
        >
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col style="width: 50px;" *ngIf="hasPermission('action.update')">
            <col style="width: 50px;">
            <col style="width: 250px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th pResizableColumn translate *ngIf="hasPermission('action.update')"></th>
            <th pResizableColumn translate>common.table.index</th>
            <th pResizableColumn pSortableColumn="nameCate" translate>app.settings.category.generalname <p-sortIcon [field]="'nameCate'"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="description" translate>app.settings.category.description <p-sortIcon [field]="'description'"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="effectiveDate" translate>generalStandard.effectiveDate <p-sortIcon [field]="'effectiveDate'"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="expiredDate" translate>generalStandard.expiredDate <p-sortIcon [field]="'expiredDate'"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="sortOrder" translate>app.settings.category.sort_order <p-sortIcon [field]="'sortOrder'"></p-sortIcon>
            </th>
            <th pResizableColumn translate>profile.table.tt <p-sortIcon></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex">
          <tr>
            <td class="vt-align-center" style="overflow: initial;" *ngIf="hasPermission('action.update')">
              <div ngbDropdown class="d-inline-block">
                <div ngbDropdownToggle class="vt-action-hover">
                  <img class="menu-icon" src="./../../../assets/images/home/Icon.svg" >
                </div>
                <div ngbDropdownMenu class="vt-border-radius">
                  <!-- sua -->
                  <div>
                    <button class="dropdown-item" (click)="prepareSaveOrUpdate(item)"
                            [innerHTML]="'common.button.table.acteditdropdown' | translate">
                    </button>
                  </div>
                </div>
              </div>
            </td>
            <td class="vt-align-center">{{index+1}}</td>
            <td class="vt-align-left">
              <strong>{{item.nameCate}}</strong>: {{item.nameGspg}}
            </td>
            <td class="vt-align-left">{{item.description}}</td>
            <td class="vt-align-center">{{item.effectiveDate | displayDate}}</td>
            <td class="vt-align-center">{{item.expiredDate | displayDate}}</td>
            <td class="vt-align-center">{{item.sortOrder}}</td>
            <td>
              <div class="info label-status" *ngIf="item.status == 1" translate>generalStandard.effectiveStatus</div>
              <div class="success label-status" *ngIf="item.status == 2" translate>generalStandard.notYetexpiredStatus</div>
              <div class="danger label-status" *ngIf="item.status == 3" translate>generalStandard.expiredStatus</div>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr class="emptymessage">
            <td [attr.colspan]="4" [innerHTML]="'app.noRecords' | translate">
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="paginatorleft">
          <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
