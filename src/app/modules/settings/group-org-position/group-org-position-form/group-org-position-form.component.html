<div class="card-form">
  <div class="clearfix">
    <div class="left-nav-bar pull-left row-header">
      <div>
        <img alt="back" class="img-fluid" src="./../../../../../../assets/images/home/Mask_Group_18824.png" (click)="goBack();">
        <span *ngIf="isEdit" class="title" translate>app.settings.privateStandard.privateStandarEdit</span>
        <span *ngIf="isView" class="title" translate>app.settings.privateStandard.privateStandarView</span>
      </div>
    </div>
    <div class="right-nav-bar pull-right left-option">
        <ul class="header-right sys-ul space-line">
          <li>
            <button class="btn btn-sm vt-btn mt-btn ng-star-inserted" type="button" (click)="goBack();" [innerHTML]="'common.button.out' | translate">
            </button>
          </li>
          <li>
            <button class="btn btn-sm vt-btn btn-submit mt-btn btn-header-right ng-star-inserted" type="button" (click)="navigate()" [innerHTML]="'common.button.icon.edit' | translate">
            </button>
          </li>
        </ul>
    </div>
  </div>
</div>
<div class="info">
  <div class="panel panel-default card-info" *ngIf="(hasPermission('action.update') && isEdit) || (hasPermission('action.insert') && !isEdit)" >
    <form id="formSave" [formGroup]="formSave">
        <div class="panel-heading vt-relative">
            <strong>
              <!-- <span *ngIf="isEdit" translate>app.settings.privateStandard.privateStandarEdit</span>
              <span *ngIf="isView" translate>app.settings.privateStandard.privateStandarView</span> -->
              <span class="ml-2 title-info">Thông tin nhóm chức danh theo đơn vị</span>
            </strong>
          </div>
      <div class="panel-body padding-xl ui-g">
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
            {{'grouporgposition.group' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3">
            <select-filter
              [placeHolder]="'common.label.cboMustSelect'"
              [property]="f['groupId']"
              [options]="groupList"
              optionLabel="name"
              optionValue="categoryId"
              autofocus="autofocus"
              (onChange) = 'processSearchGeneral()'
              [disabled] = "true"
              >
            </select-filter>
            <app-control-messages [control]="f['groupId']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-3 ui-lg-3 control-label vt-align-right">
            {{'common.status.approved' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3" style="line-height: 32px;">
            <div class="form-check-inline">
              <label class="i-checks">
                <input type="radio" [attr.disabled]="true" class="form-check-input control-label" id="isApproved_1" [value]="1" name="isApproved" formControlName="isApproved">
                <i></i>
                {{'common.status.isApproved' | translate}}
              </label>
            </div>
            <div class="form-check-inline">
              <label class="i-checks">
                <input type="radio" [attr.disabled]="true" class="form-check-input control-label" id="isApproved_2" [value]="2" name="isApproved"  formControlName="isApproved">
                <i></i>
                {{'common.status.unApproved' | translate}}
              </label>
            </div>
            <app-control-messages [control]="f['isApproved']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
            {{'common.label.title' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3">
            <data-picker 
              [property]="f['positionId']" 
              systemCode="political" 
              operationKey="action.view"
              adResourceKey="resource.groupOrgPosition" 
              objectBO="PositionBO" 
              codeField="code" nameField="name"
              selectField="positionId" 
              [isRequiredField]="true"
              [disabled] = "true"
              >
            </data-picker>
            <app-control-messages [control]="f['positionId']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-3 ui-lg-3 control-label vt-align-right">
            {{'document.label.organization' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3">
            <org-selector 
              [property]="f['organizationId']" 
              operationKey="action.view"
              adResourceKey="resource.groupOrgPosition" 
              [defaultValue]="true" 
              [isRequiredField]="true"
              [disabled] = "true"
              >
            </org-selector>
            <app-control-messages [control]="f['organizationId']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-3 ui-lg-2 control-label vt-align-right">
            {{'app.organization.effectiveDate' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3">
            <date-picker [property]="f['effectiveDate']" [disabled] = "true">
            </date-picker>
            <app-control-messages [control]="f['effectiveDate']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-3 ui-lg-3 control-label vt-align-right">
            {{'app.organization.expiredDate' | translate}}
          </label>
          <div class="ui-g-12 ui-md-3 ui-lg-3">
            <date-picker [property]="f['expiredDate']" [disabled] = "true">
            </date-picker>
            <app-control-messages [control]="f['expiredDate']"></app-control-messages>
          </div>
        </div>
      </div>
      <div class="pannel-footer" style="padding: 12px;">
        <p-tabView class="tab-view">
          <p-tabPanel 
            #compositionDialogueTab 
            header="{{'app.settings.category.standardGroupPostionList' | translate}}" 
            [selected]="isView"
            >
            <p-table 
              #ptable 
              [value]="resultList.data" 
              [paginator]="resultList.data && resultList.data.length" 
              (onLazyLoad)="processSearchGeneral($event)"
              [lazy]="true" 
              [rows]="changeRow"
              [totalRecords]="resultList.recordsTotal"
              [scrollable]="true" 
              [responsive]="true" 
              [lazyLoadOnInit]="false"
              tableStyleClass="table table-wrapper table-hover table-striped b-t b-b"
              [resizableColumns]="true" 
              >
              <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                  <col style="width: 50px;">
                  <col style="width: 200px;">
                  <col style="width: 200px;">
                </colgroup>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th translate pResizableColumn>common.table.index</th>
                  <th pSortableColumn="nameCate" translate pResizableColumn>app.settings.category.generalname <p-sortIcon [field]="'nameCate'"></p-sortIcon></th>
                  <th pSortableColumn="description" translate pResizableColumn>app.settings.category.description <p-sortIcon [field]="'description'"></p-sortIcon></th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item let-index="rowIndex">
                <tr>
                  <td class="vt-align-center">{{index+1}}</td>
                  <td class="vt-align-left"><strong>{{item.nameCate}}</strong>: {{item.nameGspg}}</td>
                  <td class="vt-align-left">{{item.description}}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr class="emptymessage">
                  <td [attr.colspan]="3" [innerHTML]="'app.noRecords' | translate">
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="paginatorleft">
                <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
              </ng-template>
            </p-table>
          </p-tabPanel>
          <p-tabPanel header="{{'app.settings.privateStandard.standardGroupPostionList' | translate}}" [selected]="isEdit">
            <!-- tab tieu chuan rieng -->
            <div *ngIf="isEdit" class="vt-align-right private-standard">
              <button type="button" *ngIf="hasPermission('action.insert')" (click)="prepareSaveOrUpdate()" class="btn btn-sm vt-btn btn-submit" [innerHTML]="'common.button.icon.addNew' | translate"></button>
            </div>
            <p-table 
              #ptablePrivate
              [value]="privateResultList.data" 
              [paginator]="privateResultList.data && privateResultList.data.length" 
              (onLazyLoad)="processSearchPrivateStandard($event)"
              [lazy]="true" 
              [rows]="changeRow"
              [totalRecords]="privateResultList.recordsTotal"
              [scrollable]="true" 
              [responsive]="true" 
              [lazyLoadOnInit]="false"
              tableStyleClass="table table-wrapper table-hover table-striped b-t b-b"
              [resizableColumns]="true" 
              >
              <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                  <col style="width: 50px;" *ngIf="hasPermission('action.update')&&isEdit">
                  <col style="width: 50px;">
                  <col style="width: 200px;">
                  <col style="width: 200px;">
                  <col style="width: 100px;">
                  <col style="width: 100px;">
                  <col style="width: 100px;">
                  <col style="width: 100px;">
                </colgroup>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th translate pResizableColumn *ngIf="hasPermission('action.update')&&isEdit"></th>
                  <th translate pResizableColumn>common.table.index</th>
                  <th pSortableColumn="nameCate" translate pResizableColumn>app.settings.privateStandard.privateStandarnameForm <p-sortIcon [field]="'nameCate'"></p-sortIcon>
                  </th>
                  <th pSortableColumn="description" translate pResizableColumn>app.settings.category.description <p-sortIcon [field]="'description'"></p-sortIcon>
                  </th>
                  <th pSortableColumn="effectiveDate" translate pResizableColumn>generalStandard.effectiveDate <p-sortIcon [field]="'effectiveDate'"></p-sortIcon>
                  </th>
                  <th pSortableColumn="expiredDate" translate pResizableColumn>generalStandard.expiredDate <p-sortIcon [field]="'expiredDate'"></p-sortIcon>
                  </th>
                  <th pSortableColumn="sortOrder" translate pResizableColumn>app.settings.category.sort_order <p-sortIcon [field]="'sortOrder'"></p-sortIcon>
                  </th>
                  <th translate pResizableColumn>profile.table.tt <p-sortIcon></p-sortIcon>
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item let-index="rowIndex">
                <tr>
                  <td class="vt-align-center" style="overflow: initial !important;">
                    <div ngbDropdown class="d-inline-block">
                        <div ngbDropdownToggle class="vt-action-hover">
                            <img class="menu-icon" src="./../../../assets/images/home/Icon.svg">
                        </div>
                        <div ngbDropdownMenu class="vt-border-radius">
                          <!-- Sửa -->
                          <button *ngIf="hasPermission('action.update')&&isEdit" class="dropdown-item"
                                  (click)="prepareSaveOrUpdate(item)"
                                  [innerHTML]="'common.button.table.acteditdropdown' | translate">
                          </button>
                        </div>
                    </div>
                  </td>
                  <td class="vt-align-center">{{index+1}}</td>
                  <td class="vt-align-left"><strong>{{item.nameCate}}</strong>: {{item.namePspg}}</td>
                  <td class="vt-align-left">{{item.description}}</td>
                  <td class="vt-align-center">{{item.effectiveDate | displayDate}}</td>
                  <td class="vt-align-center">{{item.expiredDate | displayDate}}</td>
                  <td class="vt-align-center">{{item.sortOrder}}</td>
                  <td>
                    <div class="info label-status" *ngIf="item.status == 1" translate>generalStandard.effectiveStatus</div>
                    <div class="success label-status" *ngIf="item.status == 2" translate>generalStandard.notYetexpiredStatus</div>
                    <div class="danger label-status" *ngIf="item.status == 3" translate>generalStandard.expiredStatus</div>
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr class="emptymessage">
                  <td [attr.colspan]="isEdit? 7 : 6" [innerHTML]="'app.noRecords' | translate">
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="paginatorleft">
                <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="privateResultList"></table-footer>
              </ng-template>
            </p-table>
          </p-tabPanel>
        </p-tabView>
      </div>
    </form>
  </div>
  <div *ngIf="!(hasPermission('action.update') && isEdit) && !(hasPermission('action.insert') && !isEdit)">
    {{'common.haveNoPermission' | translate}}
  </div>
</div>
