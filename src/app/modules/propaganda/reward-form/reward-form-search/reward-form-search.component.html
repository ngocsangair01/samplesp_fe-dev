<div id="searchPage">
  <div id="searchArea">
    <div class="panel panel-default">
        <div class="panel-heading" >
          <strong class="text-u-c">
            <i class="fa fa-th"></i> 
            {{'propaganda.rewardFormManager' | translate}}
          </strong>
        </div>
        <form [formGroup]="formSearch" id="formSearch">
          <div class="panel-body padding-xl ui-g">
            <div class="ui-g-12 vt-row">
              <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
                {{'propaganda.rewardFormCode' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <input type="text" class="form form-control" name="code" formControlName="code" maxlength="200" [autoFocus]="true">
                <app-control-messages [control]="f['code']"></app-control-messages>
              </div>
              <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
                {{'propaganda.rewardFormName' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <input type="text" class="form form-control" name="name" formControlName="name" maxlength="200" >
                <app-control-messages [control]="f['name']"></app-control-messages>
              </div>
            </div>
            <div class="ui-g-12 vt-row">
              <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
                {{'propaganda.rewardFormFromEffectiveDate' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <date-picker
                  [property]="f['effectiveDate']">
                </date-picker>
                <app-control-messages [control]="f['effectiveDate']"></app-control-messages>
              </div>
              <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
                {{'propaganda.rewardFormToEffectiveDate' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <date-picker
                  [property]="f['toEffectiveDate']">
                </date-picker>
                <app-control-messages [control]="f['toEffectiveDate']"></app-control-messages>
              </div>
            </div>
            <div class="ui-g-12 vt-row">
              <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
                {{'propaganda.rewardFormCategory' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <multi-select-filter  
                [property]="f['listRewardCategoryChoose']"
                [options]="lstRewardCategory"
                optionLabel="name"
                optionValue="id"
                [filterPlaceHolder]="'common.label.cboSelectAll'">
                </multi-select-filter>
                <app-control-messages [control]="f['listRewardCategoryChoose']"></app-control-messages>
              </div>
            </div>
          </div>
          <div class="panel-footer vt-area-button">
            <button type="submit" class="btn btn-sm btn-info" *ngIf="hasPermission('action.view')" (click)="processSearch()"  [innerHTML]="'common.button.icon.search' | translate" ></button>
            <button type="button"  class="btn btn-sm btn-info" *ngIf="hasPermission('action.insert')"  (click)="prepareSaveOrUpdate()"  [innerHTML]="'common.button.icon.addNew' | translate" ></button>
            <button type="button"  class="btn btn-sm btn-info" *ngIf="hasPermission('action.export')"  (click)="processExport()"  [innerHTML]="'common.button.icon.exportFile' | translate" ></button>
          </div>
        </form>
    </div>
  </div>
</div>
<div id="listArea">
  <div class="panel panel-default">
    <div class="panel-heading vt-relative">
      <strong class="text-u-c">
        <i class="fa fa-th"></i> {{'propaganda.rewardFormList' | translate}}
      </strong>
    </div>
    <div class="panel-body panel-table">
        <p-table
        #ptable
        [value]="resultList.data"
        [paginator]="true"
        (onLazyLoad)="processSearch($event)"
        [lazy]="true" [rows]="changeRow"
        [totalRecords]="resultList.recordsTotal"
        [scrollable]="true"
        [lazyLoadOnInit]="false"
        tableStyleClass="table table-wrapper table-hover table-striped b-t b-b">
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col class="size-1">
            <col class="size-1">
            <col *ngIf="hasPermission('action.update')" class="size-1">
            <col *ngIf="hasPermission('action.delete')" class="size-1">
            <col class="size-7">
            <col class="size-12">
            <col class="size-12">
            <col class="size-4">
            <col class="size-4">
            <col class="size-4">
            <col class="size-12">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th>{{'common.table.index' | translate}}</th>
            <th>{{'common.label.view' | translate}}</th>
            <th *ngIf="hasPermission('action.update')" >{{'common.label.edit' | translate}}</th>
            <th *ngIf="hasPermission('action.delete')">{{'common.label.delete' | translate}}</th>
            <th [pSortableColumn]="'code'">
              {{'propaganda.rewardFormCode' | translate}}
              <p-sortIcon [field]="'code'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'name'">
              {{'propaganda.rewardFormName' | translate}}
              <p-sortIcon [field]="'name'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'rewardCategory'">
              {{'propaganda.rewardFormCategory' | translate}}
              <p-sortIcon [field]="'rewardCategory'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'effectiveDate'">
              {{'propaganda.rewardFormEffectiveDate' | translate}}
              <p-sortIcon [field]="'effectiveDate'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'expiredDate'">
              {{'propaganda.rewardFormExpiredDate' | translate}}
              <p-sortIcon [field]="'expiredDate'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'freeIncomeTax'">
              {{'propaganda.rewardFreeIncomeTax' | translate}}
              <p-sortIcon [field]="'freeIncomeTax'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'description'">
              {{'propaganda.rewardFormDescription' | translate}}
              <p-sortIcon [field]="'description'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex+1">
          <tr>
            <!--body-->
            <td class="vt-align-center">{{index}}</td>
            <td class="vt-align-center" >
              <a class="btn-table edit" (click)="processView(item, true)"  title="{{'common.label.view' | translate}}" ><i class="fas fa-eye"></i></a>
            </td>
            <td   class="vt-align-center" *ngIf="hasPermission('action.update')">
                <a class="btn-table edit" (click)="prepareSaveOrUpdate(item)" title="{{'common.label.edit' | translate}}" ><i class="fa fa-edit"></i></a>
            </td>
            <td class="vt-align-center" *ngIf="hasPermission('action.delete')" >
              <a class="btn-table delete" (click)="processDelete(item)"  title="{{'common.label.delete' | translate}}" ><i class="fa fa-trash-alt"></i></a>
            </td>
            <td class="vt-align-center">
              {{item.code}}
            </td>
            <td class="vt-align-left">
              {{item.name}}
            </td>
            <td class="vt-align-left">
              <span *ngIf="item.rewardCategory === 1" >Ngân sách nhà nước</span>
              <span *ngIf="item.rewardCategory === 2" >Khen thưởng tập đoàn</span>
              <span *ngIf="item.rewardCategory === 3" >Khác</span>
            </td>
            <td class="vt-align-center">
              {{item.effectiveDate | displayDate}}
            </td>
            <td class="vt-align-center">
              {{item.expiredDate | displayDate}}
            </td>
            <td class="vt-align-right">
              {{item.freeIncomeTax}}
            </td>
            <td class="vt-align-left">
              {{item.description}}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr class="emptymessage">
            <td [attr.colspan]="10" [innerHTML]="'app.noRecords' | translate">
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="paginatorleft">
          <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
        </ng-template>
        </p-table>
    </div>
  </div>
</div>
