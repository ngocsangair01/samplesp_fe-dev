<div id="searchPage">
  <div id="searchArea">
    <div class="panel panel-default">
      <div class="panel-heading">
        <strong class="text-u-c">
          <i class="fa fa-th"></i>
          {{'common.label.search.info' | translate}}
        </strong>
      </div>
      <form [formGroup]="formSearch" id="formSearch">
        <div class="panel-body padding-xl ui-g">
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'propaganda.rewardDecideOrg' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector [property]="f['organizationId']" operationKey="action.view"
                adResourceKey="resource.propaganda" [defaultValue]="true">
              </org-selector>
              <app-control-messages [control]="f['organizationId']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'propaganda.rewardDecideEmp' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <data-picker #data [property]="f['employeeId']" systemCode="political" operationKey="action.view"
                adResourceKey="resource.propaganda" objectBO="EmployeeBO" codeField="employeeCode" nameField="fullName"
                emailField="email" selectField="employeeId" [filterCondition]="filterConditionEmp"
                mobileNumberField="mobileNumber">
              </data-picker>
              <app-control-messages [control]="f['employeeId']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'propaganda.rewardDecideCode' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" name="rewardDecideCode" formControlName="rewardDecideCode"
                maxlength="100" [autoFocus]="true">
              <app-control-messages [control]="f['rewardDecideCode']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'propaganda.rewardDecideStatus' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [placeHolder]="'common.label.cboSelectAll'" [property]="f['status']" [options]="listStatus"
                optionLabel="name" optionValue="id">
              </select-filter>
              <app-control-messages [control]="f['status']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'propaganda.rewardDecideFromdecideDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker [property]="f['decideDate']">
              </date-picker>
              <app-control-messages [control]="f['decideDate']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'propaganda.rewardDecideTodecideDate' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker [property]="f['toDecideDate']">
              </date-picker>
              <app-control-messages [control]="f['toDecideDate']"></app-control-messages>
            </div>
          </div>
        </div>
        <div class="panel-footer vt-area-button">
          <button type="submit" class="btn btn-sm btn-info" (click)="processSearch()"
            [innerHTML]="'common.button.icon.search' | translate"></button>
          <button type="button" class="btn btn-sm btn-info" *ngIf="hasPermission('action.insert')"
            (click)="prepareSaveOrUpdate()" [innerHTML]="'common.button.icon.addNew' | translate"></button>
          <button type="button" class="btn btn-sm btn-info" *ngIf="hasPermission('action.export')"
            (click)="processExport()" [innerHTML]="'common.button.icon.exportFile' | translate"></button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="listArea">
  <div class="panel panel-default">
    <div class="panel-heading vt-relative">
      <strong class="text-u-c">
        <i class="fa fa-th"></i> {{'propaganda.rewardDecideList' | translate}}
      </strong>
    </div>
    <div class="panel-body panel-table">
      <p-table #ptable [value]="resultList.data" [paginator]="true" (onLazyLoad)="processSearch($event)" [lazy]="true"
        [rows]="changeRow" [totalRecords]="resultList.recordsTotal" [scrollable]="true" [lazyLoadOnInit]="false"
        tableStyleClass="table table-wrapper table-hover table-striped b-t b-b" styleClass="controlOverflow">
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col class="size-1">
            <col class="size-5">
            <col class="size-12">
            <col class="size-6">
            <col class="size-12">
            <col class="size-5">
            <col class="size-4">
            <col class="size-5">
            <col class="size-4">
            <col class="size-4">
            <col class="size-12">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th>{{'common.table.index' | translate}}</th>
            <th translate>common.label.action</th>
            <th [pSortableColumn]="'organizationId'">
              {{'propaganda.rewardDecideOrg' | translate}}
              <p-sortIcon [field]="'organizationId'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'employeeId'">
              {{'propaganda.rewardDecideEmp' | translate}}
              <p-sortIcon [field]="'employeeId'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'rewardDecideCode'">
              {{'propaganda.rewardDecideCode' | translate}}
              <p-sortIcon [field]="'rewardDecideCode'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'totalAmountReward'">
              {{'propaganda.rewardDecideTotalAmountReward' | translate}}
              <p-sortIcon [field]="'totalAmountReward'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'decideDate'">
              {{'propaganda.rewardDecideDecideDate' | translate}}
              <p-sortIcon [field]="'decideDate'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'status'">
              {{'propaganda.rewardDecideStatus' | translate}}
              <p-sortIcon [field]="'status'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'paymentMode'">
              {{'rewardDecide.paymentMode' | translate}}
              <p-sortIcon [field]="'paymentMode'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'statusSync'">
              {{'rewardDecide.statusSync' | translate}}
              <p-sortIcon [field]="'statusSync'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'errorMessageSync'">
              {{'rewardDecide.errorMessageSync' | translate}}
              <p-sortIcon [field]="'errorMessageSync'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex+1">
          <tr>
            <!--body-->
            <td class="vt-align-center">{{index}}</td>
            <td class="vt-align-center">
              <div ngbDropdown class="d-inline-block">
                <button class="btn btn-sm btn-info" ngbDropdownToggle translate>common.label.action</button>
                <div ngbDropdownMenu>
                  <!-- Xem quyet dinh -->
                  <div *ngIf="hasPermission('action.view')">
                    <button class="dropdown-item" (click)="processView(item)"
                      [innerHTML]="'common.button.table.viewdropdown' | translate">
                    </button>
                  </div>
                  <!-- Sua quyet dinh -->
                  <div *ngIf="(item.status == 0 || item.status == 2) && hasPermission('action.update')">
                    <button class="dropdown-item" (click)="prepareSaveOrUpdate(item)"
                      [innerHTML]="'common.button.table.acteditdropdown' | translate">
                    </button>
                  </div>
                  <!-- Xoa quyet dinh -->
                  <div *ngIf="(item.status == 0 || item.status == 2) && hasPermission('action.delete')">
                    <button class="dropdown-item" (click)="processDelete(item)"
                      [innerHTML]="'propagandaRewardDecide.removedropdown' | translate">
                    </button>
                  </div>
                  <!-- trinh ky -->
                  <div
                    *ngIf="item.status !== 1 && item.status !== 3 && hasPermission('action.update') && item.signDocumentId > 0">
                    <button class="dropdown-item" (click)="prepareSign(item)"
                      [innerHTML]="'common.button.table.actSign' | translate">
                    </button>
                  </div>
                  <div *ngIf="item.attachSignDocumentId">
                    <button class="dropdown-item" (click)="previewFileSigning(item.signDocumentId)"
                      [innerHTML]="'common.button.table.previewFileSigning' | translate">
                    </button>
                </div>
                </div>
              </div>
            </td>
            <td class="vt-align-left">
              {{item.orgName}}
            </td>
            <td class="vt-align-left">
              {{item.employeeName}}
            </td>
            <td class="vt-align-left">
              {{item.rewardDecideCode}}
            </td>
            <td class="vt-align-right">
              <span *ngIf="item.totalAmountReward != null">{{item.totalAmountReward | formatCurrency:"VND"}} VNĐ</span>
            </td>
            <td class="vt-align-center">
              {{item.decideDate | displayDate}}
            </td>
            <td class="vt-align-left">
              <span class="label-status notYet" *ngIf="item.status === 0" translate>rewardProposal.status.0</span>
              <span class="label-status warning" *ngIf="item.status === 1" translate>rewardProposal.status.1</span>
              <span class="label-status danger" *ngIf="item.status === 2" translate>rewardProposal.status.2</span>
              <span class="label-status info" *ngIf="item.status === 3" translate>rewardProposal.status.3</span>
            </td>
            <td class="vt-align-center">
              <div *ngIf="item.paymentMode == 'UNC'">Ủy nhiệm chi</div>
              <div *ngIf="item.paymentMode == 'TM'">Tiền mặt</div>
              <div *ngIf="item.paymentMode == 'LC'">LC</div>
              <div *ngIf="item.paymentMode == 'CMTND'">CMTND</div>
            </td>
            <td class="vt-align-left">
              <div class="label-status info" *ngIf="item.statusSync == '00'" translate>
                label.rewardDecide.statusSync00</div>
              <div class="label-status danger" *ngIf="item.statusSync == '01'" translate>
                label.rewardDecide.statusSync01</div>
              <div class="label-status danger" *ngIf="item.statusSync == '02'" translate>
                label.rewardDecide.statusSync02</div>
              <div class="label-status danger" *ngIf="item.statusSync == '03'" translate>
                label.rewardDecide.statusSync03</div>
              <div class="label-status danger" *ngIf="item.statusSync == '04'" translate>
                label.rewardDecide.statusSync04</div>
              <div class="label-status danger" *ngIf="item.statusSync == '05'" translate>
                label.rewardDecide.statusSync05</div>
              <div class="label-status danger" *ngIf="item.statusSync == '99'" translate>
                label.rewardDecide.statusSync99</div>
            </td>
            <td class="vt-align-left">{{item.errorMessageSync}}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr class="emptymessage">
            <td [attr.colspan]="11" [innerHTML]="'app.noRecords' | translate">
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="paginatorleft">
          <table-footer  (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>