<div class="card-reward">
  <div class="clearfix">
    <div class="left-nav-bar pull-left row-header">
      <div>
        <img alt="back" class="img-fluid" src="./../../../../../../assets/images/home/Mask_Group_18824.png" (click)="goBack();">
        <span *ngIf = "isView" class="title" translate> tab.rewardPropose.label.rewardInfoApproveView</span>
          <span *ngIf = "!isView" class="title" translate> tab.rewardPropose.label.rewardInfoApprove</span>
      </div>
    </div>
    <div class="right-nav-bar pull-right left-option">
        <ul class="header-right sys-ul space-line">
          <li *ngIf="!isView">
            <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="processSaveOrUpdate(1)" [innerHTML]="'common.button.icon.save' | translate">
            </button>
          </li>
          <li *ngIf="!isView">
            <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="processSaveOrUpdate(2)" [innerHTML]="'common.button.icon.completePropose' | translate">
            </button>
          </li>
          <li *ngIf="!isView">
            <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="cancelOffer()" [innerHTML]="'common.button.icon.cancelOffer' | translate">
            </button>
          </li>
          <li>
            <button class="btn btn-sm vt-btn ng-star-inserted" type="button" (click)="goBack();" [innerHTML]="'common.button.out' | translate">
            </button>
          </li>
          <li>
            <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="onPreviewFile()" [innerHTML]="'common.button.icon.previewFile' | translate">
            </button>
          </li>
<!--          <li>-->
<!--            <button type="button" *ngIf="!isView && hasPermission('action.import')" class="btn btn-sm btn-info btn-import-file"-->
<!--                    (click)="openFormImport()" [innerHTML]="'bonusType.importFile' | translate">adadd</button>-->
<!--          </li>-->
        </ul>
    </div>
  </div>
</div>
<div class="info">
  <form id="formSave" [formGroup]="formSave">
    <div
      *ngIf="hasPermission('action.approval')">
      <div class="panel panel-default card-info">
        <div class="panel-heading">
          <strong>
            <!-- <span *ngIf = "isView" translate> tab.rewardPropose.label.rewardInfoApproveView</span>
            <span *ngIf = "!isView" translate> tab.rewardPropose.label.rewardInfoApprove</span> -->
            <span class="ml-2 title-info">Thông tin xét duyệt đề xuất khen thưởng</span>
          </strong>
        </div>
        <div class="panel-body padding-xl ui-g">
          <!--          lĩnh vực khen thưởng-->
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
              {{'rewardPropose.rewardType' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3 position-relative">
              <select-filter [placeHolder]="'common.label.cboMustSelect'" [property]="f['rewardType']"
                             [options]="lstRewardType" optionLabel="name" optionValue="id" (onChange)="onRewardTypeChange()"
                             [disabled]="isView || isEdit">
              </select-filter>
              <app-control-messages [control]="f['rewardType']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <!-- Tên đề xuất -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
              {{'rewardPropose.rewardProposeName' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" name="name" formControlName="name" maxlength="200"
                [attr.disabled]="isView || isEdit ? true : null">
              <app-control-messages [control]="f['name']"></app-control-messages>
            </div>
            <!-- Đơn vị đề xuất -->
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
              {{'rewardPropose.rewardDecideOrg' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector [property]="f['proposeOrgId']" operationKey="action.view"
                adResourceKey="resource.rewardPropose" [defaultValue]="true" [disabled]="isView || isEdit">
              </org-selector>
              <app-control-messages [control]="f['proposeOrgId']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <!-- loại đề xuất -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'rewardPropose.proposalType' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [placeHolder]="'common.label.cboSelect'" [property]="f['proposalType']" [options]="proposalTypeOptions"
                             optionLabel="name" optionValue="value" [disabled]="true">
              </select-filter>
              <app-control-messages [control]="f['proposalType']"></app-control-messages>
            </div>
            <!-- kỳ khen thưởng -->
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
              {{'rewardPropose.periodType' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['periodType']" [options]="lstPeriodType" optionLabel="name" optionValue="id"
                [placeHolder]="'common.label.cboMustSelect'" [disabled]="isView || isEdit">
              </select-filter>
              <app-control-messages [control]="f['periodType']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <!-- Đơn vị xét duyệt -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
              {{'rewardPropose.reviewOrganization' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector [property]="f['approvalOrgId']" operationKey="action.view"
                adResourceKey="resource.rewardPropose" [defaultValue]="true" [disabled]="isView || isEdit">
              </org-selector>
              <app-control-messages [control]="f['approvalOrgId']"></app-control-messages>
            </div>
            <!-- Đơn vị trình ký quyết định -->
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
              {{'rewardPropose.signOrganization' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector [property]="f['signOrgId']" operationKey="action.view" adResourceKey="resource.rewardPropose"
                [defaultValue]="true" [disabled]="isView || isEdit" (onChange)="onSignOgrChange($event)">
              </org-selector>
              <app-control-messages [control]="f['signOrgId']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <!-- năm -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
              {{'rewardPropose.year' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['proposeYear']" [options]="listYear" optionLabel="year" optionValue="year"
                [placeHolder]="'common.label.cboMustSelect'" [disabled]="isView || isEdit">
              </select-filter>
              <app-control-messages [control]="f['proposeYear']"></app-control-messages>
            </div>
            <!-- Người tạo-->
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right" *ngIf="isView">
              {{'common.label.createdBy' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3" *ngIf="isView">
              <input type="text" class="form form-control" name="createdBy"
                formControlName="createdBy" maxlength="200" [attr.disabled]="isView ? true: null">
              <app-control-messages [control]="f['createdBy']"></app-control-messages>
            </div>
          </div>
  
          <div class="ui-g-12 vt-row" *ngIf="isView">
            <!-- trạng thái -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'common.label.status' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
                <select-filter [placeHolder]="'common.label.cboSelectAll'" [property]="f['status']" [options]="listStatus"
                optionLabel="name" optionValue="id" [disabled]="isView ? true: null">
              </select-filter>
              <app-control-messages [control]="f['status']"></app-control-messages>
            </div>
            <!-- Ngày tạo-->
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'issue.resolution.create.date.label' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <date-picker [property]="f['createdDate']" [disabled]='isView'>
              </date-picker>
              <app-control-messages [control]="f['createdDate']"></app-control-messages>
            </div>
          </div>
  
          <div class="ui-g-12 vt-row">
            <!-- Trình ký lãnh đạo đơn vị -->
            <div class="ui-g-6">
              <label class="ui-g-12 ui-md-6 ui-lg-4 control-label vt-align-right">
                {{'rewardPropose.isRequiredSign' | translate}}
              </label>
              <div class="ui-g-12 ui-md-2 ui-lg-2">
                <input type="checkbox" name="isRequiredSign" formControlName="isRequiredSign" style="width: 18px;
                height: 1.5rem;" [attr.disabled]="isView || isEdit ? true : null" [value]="0">
              </div>
              <label class="ui-g-8 ui-md-2 ui-lg-3 control-label vt-align-right label-info">
                {{'rewardPropose.isSynthetic' | translate}}
              </label>
              <div class="ui-g-12 ui-md-4 ui-lg-1 checkbox-info">
                <input type="checkbox" name="isSynthetic" formControlName="isSynthetic" style="width: 18px;
                height: 1.5rem;" [attr.disabled]="isView || isEdit ? true : null" [value]="0">
              </div>
            </div>
  
            <!-- File đính kèm -->
            <label class="ui-g-12 ui-md-2 control-label vt-align-right">
              {{'common.label.attachmentFile' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <multi-file-chooser [property]="f['attachedFiles']" fileName="attachedFiles" [validMaxSize]="50"
                validType="png,jpg,gif,tiff,bmp,xls,xlsx,doc,docx,pdf,rar,zip,7z"
                [disabled]="isView || isEdit? true : null">
              </multi-file-chooser>
              <app-control-messages [control]="f['attachedFiles']"></app-control-messages>
              <div [innerHTML]="'common.button.note' | translate">
              </div>
            </div>
          </div>
          <reward-decide-table [dataFormRewardDecide]="formRewardDecideTable.asObservable()"
              *ngIf="formSave.controls['isSynthetic'].value"
                >
          </reward-decide-table>
          <div class="ui-g-12 ui-md-12 ui-lg-12 import-file">
            <button type="button" *ngIf="!isView && hasPermission('action.import')" class="btn btn-sm btn-info btn-import-file"
                    (click)="openFormImport()" [innerHTML]="'bonusType.importFile' | translate">adadd</button>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="hasPermission('action.approval')">
      <div style="width: 100%">
        <p-tabView class="tab-view">
          <p-tabPanel header="{{'rewardPropose.label.rewardProposeDetail' | translate}}">
            <p-tabView [(activeIndex)]="activeIndex" class="tab-item">
              <!-- Khen thuong tap the -->
              <p-tabPanel header="{{'tab.rewardPropose.group' | translate}} ({{formRewardGroupInside ? formRewardGroupInside.value.length : 0}})">
                <reward-group-position [resetFormArray]="resetFormArray.asObservable()"
                                        [setData]="setData.asObservable()" [processingData]="processingData" [isViewFile]="true"
                                        (formRewardGroupOutput)="getFormRewardGroupInside($event)" [dataImportGroupInsangnn]="dataImportGroupInsangnn.asObservable()"
                                        [isHideProposeSign]="false" [pageFocus]="pageFocus.asObservable()">
                </reward-group-position>
              </p-tabPanel>
              <!-- Khen thuong CBCNV -->
              <p-tabPanel header="{{'tab.rewardPropose.rewardEmployee' | translate}} ({{formRewardPersonInside ? formRewardPersonInside.value.length : 0}})">
                <reward-employee-position [resetFormArray]="resetFormArray.asObservable()" [isViewFile]="true"
                                          [setData]="setData.asObservable()"
                                          [processingData]="processingData"
                                          (formRewarPersonalOutput)="getFormRewardPersonalInside($event)"
                                          [dataImportStaffInsangnn]="dataImportStaffInsangnn.asObservable()" [isHideProposeSign]="false" [hideIncludeStatement]="true" [pageFocus]="pageFocus.asObservable()"></reward-employee-position>
              </p-tabPanel>
              <!-- Tap the ngoai sangnn -->
              <p-tabPanel header="{{'tab.rewardPropose.organizationOut' | translate}} ({{formRewardGroupOutside ? formRewardGroupOutside.value.length: 0}})">
                <reward-organization-out [resetFormArray]="resetFormArray.asObservable()"
                                          [setData]="setData.asObservable()"
                                          [processingData]="processingData"
                                          (formRewardOrgOutside)="getFormRewardGroupOutSide($event)"
                                          [dataImportGroupOutsangnn]="dataImportGroupOutsangnn.asObservable()" [pageFocus]="pageFocus.asObservable()"></reward-organization-out>
              </p-tabPanel>
              <!-- Ca nhan ngoai sangnn -->
              <p-tabPanel header="{{'tab.rewardPropose.individualsOut' | translate}} ({{formRewardPersonOutside ? formRewardPersonOutside.value.length: 0}})">
                <reward-individuals-out [resetFormArray]="resetFormArray.asObservable()"
                                        [setData]="setData.asObservable()"
                                        [processingData]="processingData"
                                        (formRewardIndividualOutside)="getFormRewardPersonalOutSide($event)"
                                        [dataImportStaffOutsangnn]="dataImportStaffOutsangnn.asObservable()" [pageFocus]="pageFocus.asObservable()"></reward-individuals-out>
              </p-tabPanel>
            </p-tabView>
          </p-tabPanel>
          <!-- Chi phí -->
          <p-tabPanel header="{{'tab.rewardPropose.cost' | translate}} ">
            <reward-cost [resetFormArray]="resetFormArray.asObservable()"
                          [setData]="setData.asObservable()"
                          [pageFocus]="pageFocus.asObservable()"
                          (formRewardOrgCost) = "getFormRewardOrgCost($event)">
            </reward-cost>
          </p-tabPanel>
        </p-tabView>
      </div>

      <div class="ui-g-12 vt-row">
        <label class="ui-g-12 ui-md-6 ui-lg-1 control-label vt-align-right">
          {{'rewardPropose.reviewOfrewardProposes' | translate}}
        </label>
        <div class="ui-g-12 ui-md-6 ui-lg-2">
          <ul class="basic-info" style="font-weight: bold;">
            <li class="display-table">
              Tập thể trong sangnn: {{calIsChoseOrIsSuggest(formRewardGroupInside)}} / {{formRewardGroupInside ? formRewardGroupInside.value.length : 0}}
            </li>
            <li class="display-table">
              Ra quyết định:  {{calIsChose(formRewardGroupInside)}}
            </li>
            <li class="display-table">
              Đề xuất lên: {{calIsSuggest(formRewardGroupInside)}}
            </li>
          </ul>
        </div>
        <div class="ui-g-12 ui-md-6 ui-lg-3">
          <ul class="basic-info" style="font-weight: bold;">
            <li class="display-table">
              Cá nhân trong sangnn: {{calIsChoseOrIsSuggest(formRewardPersonInside)}} / {{formRewardPersonInside ? formRewardPersonInside.value.length : 0}}
            </li>
            <li class="display-table">
              Ra quyết định: {{calIsChose(formRewardPersonInside)}}
            </li>
            <li class="display-table">
              Đề xuất lên: {{calIsSuggest(formRewardPersonInside)}}
            </li>
          </ul>
        </div>
        <div class="ui-g-12 ui-md-6 ui-lg-3">
          <ul class="basic-info" style="font-weight: bold;">
            <li class="display-table">
              Tập thể ngoài sangnn: {{calIsChoseOrIsSuggest(formRewardGroupOutside)}} / {{formRewardGroupOutside ? formRewardGroupOutside.value.length: 0}}
            </li>
            <li class="display-table">
              Ra quyết định: {{calIsChose(formRewardGroupOutside)}}
            </li>
            <li class="display-table">
              Đề xuất lên: {{calIsSuggest(formRewardGroupOutside)}}
            </li>
          </ul>
        </div>
        <div class="ui-g-12 ui-md-6 ui-lg-3">
          <ul class="basic-info" style="font-weight: bold;">
            <li class="display-table">
              Cá nhân ngoài sangnn: {{calIsChoseOrIsSuggest(formRewardPersonOutside)}} / {{formRewardPersonOutside ? formRewardPersonOutside.value.length: 0}}
            </li>
            <li class="display-table">
              Ra quyết định: {{calIsChose(formRewardPersonOutside)}}
            </li>
            <li class="display-table">
              Đề xuất lên: {{calIsSuggest(formRewardPersonOutside)}}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </form>
  <div
    *ngIf="!hasPermission('action.approval')">
    {{'common.haveNoPermission' | translate}}
  </div>
</div>
