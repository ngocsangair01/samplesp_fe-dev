<form [formGroup]="formGroup">
  <div class="page">
    <div class="detail-area">
      <div class="panel panel-default">
        <div class="panel-heading">
          <strong class="text-u-c"><i class="fa fa-th"></i>&nbsp;{{titleSignInfor | translate}}</strong>
        </div>
        <!--pannel-body div-->
        <div class="panel-body padding-xl ui-g">
          <!-- Tài khoản sso start -->
          <div class="ui-g-12 vt-row" style="display: none;">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right ">
              {{'common.label.userVoffice' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input (blur)="submitVoffice()" type="text" formControlName="vofficeUser" name="vofficeUser" class="form-control" maxlength="100" [autoFocus]="true">
              <app-control-messages [control]="f['vofficeUser']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right ">
              {{'common.label.passwordVoffice' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input (blur)="submitVoffice()" type="password" formControlName="vofficePassword" name="vofficePassword" class="form-control"
                maxlength="100">
              <app-control-messages [control]="f['vofficePassword']"></app-control-messages>
            </div>
          </div>
          <!-- Tài khoản sso end -->
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right ">
              {{'label.resolutionsMonth.professions' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['professions']" [options]="listCbb" optionLabel="parName"
                optionValue="parValue" [placeHolder]="'common.label.cboMustSelect'" [disabled]="true">
              </select-filter>
              <app-control-messages [control]="f['professions']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right ">
              {{'label.resolutionsMonth.formalityText' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['formalityText']" [options]="listTextF" optionLabel="parName"
                optionValue="parValue" [placeHolder]="'common.label.cboMustSelect'" [disabled]="true">
              </select-filter>
              <app-control-messages [control]="f['formalityText']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right ">
              {{'document.label.confidentiality' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['confidentiality']" [options]="listConfidentiality"  optionLabel="name"
                optionValue="categoryId" [placeHolder]="'common.label.cboMustSelect'" [disabled]="true">
              </select-filter>
              <app-control-messages [control]="f['confidentiality']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right ">
              {{'document.label.urgency' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['urgent']" [options]="listUrgent"  optionLabel="name"
                optionValue="categoryId" [placeHolder]="'common.label.cboMustSelect'" [disabled]="true">
              </select-filter>
              <app-control-messages [control]="f['urgent']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
              <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right ">
                {{'label.resolutionsMonth.textSymbols' | translate}}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <input type="text" formControlName="textSymbols" name="textSymbols" class="form-control" [attr.disabled]="true"
                  maxlength="100">
                <app-control-messages [control]="f['textSymbols']"></app-control-messages>
              </div>
              <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
                {{ 'vofficeSign.label.isAutoPromulgate' | translate }}
              </label>
              <div class="ui-g-12 ui-md-6 ui-lg-3">
                <label class="i-switch bg-info m-t-xs m-r" id="isAutoPromulgate">
                  <input type="checkbox" name="isAutoPromulgate" [attr.disabled]="true" [value]="1" formControlName="isAutoPromulgate"/>
                  <i></i>
                </label>
              </div>
          </div>
          <!-- start Bổ sung luồng ban hành tự động cho nghị quyết -->
          <div class="ui-g-12">
            <!-- Ban hành tự động chỉ áp dụng với trình ký có độ mật "Thường" -->

          </div>
          <!-- end Bổ sung luồng ban hành tự động cho nghị quyết -->
        </div>
      </div>
      <!-- Thêm tab chọn đối tượng nhận văn bản *ngIf="isAutoTransferDocuemnt" -->
      <div class="panel panel-default" *ngIf="isAutoTransferDocuemnt">
        <div class="panel-heading">
          <strong class="text-u-c"><i class="fa fa-th"></i>&nbsp;{{ 'vofficeSign.label.listDocumentReceiver' | translate }}</strong>
        </div>
        <div class="panel-body panel-table">
          <!-- <transfer-auto-tab #transferAutoTab [lstPromulgate]="lstPromulgate" [disabled]="!isAuthenVoffice"></transfer-auto-tab> -->
        </div>
      </div>
      <!--  -->
      <div class="panel panel-default panel-layer-1">
        <div class="panel-heading">
          <strong class="text-u-c"><i class="fa fa-th"></i>&nbsp;{{'managerSign.listSignerTitle' | translate}}</strong>
        </div>
        <div class="panel-body panel-table">
          <p-table [scrollable]="false" [value]="formSigner.controls"
            tableStyleClass="table controls-table table-wrapper b-t b-b">
            <ng-template pTemplate="colgroup" let-columns>
              <colgroup>
                <col class="size-1">
                <col class="size-6">
                <col class="size-8">
                <col class="size-9">
                <col class="size-5">
                <col class="size-5">
                <col class="size-5">
                <col class="size-5">
              </colgroup>
            </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <th translate>common.table.index</th>
                <th translate><span class="">managerSign.listSigner.employeeId</span></th>
                <th translate><span class="">managerSign.listSigner.positionOrg</span></th>
                <th translate>vofficeSigning.imageSign.chose</th>
                <th translate>managerSign.listSigner.signImageIndex</th>
                <th translate>vofficeSign.label.sign</th>
                <th translate>common.label.order</th>
                <th translate>common.label.action</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item let-index="rowIndex">
              <tr [formGroup]="item">
                <td class="vt-align-center">
                  {{index+1}}
                </td>
                <td>
                  <data-picker [property]="item.controls.employeeId" systemCode="political" operationKey="action.view"
                    adResourceKey="resource.signDocument" objectBO="EmployeeBO" codeField="employeeCode"
                    nameField="fullName" emailField="email" selectField="employeeId" mobileNumberField="mobileNumber"
                    (onChange)="onChangeEmployee($event, item)" isNotSearchByOrgDomainData="true"
                    [disabled]="item.value.isDefaultValue ? true : null"
                    [filterCondition]="' AND obj.status = 1'">
                  </data-picker>
                  <app-control-messages [control]="item.controls.employeeId"></app-control-messages>
                </td>
                <td>
                  <select-filter [property]="item.controls.userVofficeId" [options]="item.listVofficeUser"
                    optionLabel="label" optionValue="value" [placeHolder]="'common.label.cboMustSelect'">
                  </select-filter>
                  <app-control-messages [control]="item.controls.userVofficeId"></app-control-messages>
                </td>
                <td class="vt-align-left">
                  <span *ngIf="item.signatureImages">
                    <label *ngFor="let signatureImage of item.signatureImages; index as i" class="i-checks">
                      <input type="radio" class="form-check-input control-label"
                        id="{{'signImageId_' + index + '_' + i}}" [value]="signatureImage.staffImageSignId"
                        formControlName="signImageId" [attr.disabled]="item.controls.showSignImage.value == 1 ? null : true">
                      <i></i>
                      <img [src]="signatureImage.attachBytes" width="80" height="70">
                    </label>
                  </span>
                  <span *ngIf="!item.signatureImages">
                    {{'assessmentResult.notFoundSignatureImage' | translate}}
                  </span>
                  <app-control-messages [control]="item.controls.signImageId"></app-control-messages>
                </td>
                <td class="vt-align-center">
                  <label class="m-t-xs m-r">
                    <input type="checkbox" class="form form-control" formControlName="showSignImage" [value]="1"  (change)="onChangeSignImage(item)"  [attr.disabled]="true"/>
                    <i></i>
                  </label>
                </td>
                <td class="vt-align-center">
                  <label class="m-t-xs m-r">
                    <input type="checkbox" class="form form-control" formControlName="isSign" [value]="1" [attr.disabled]="true"/>
                    <i></i>
                  </label>
                </td>
                <td class="vt-align-center">
                  <button *ngIf="index > 0 && index != formSigner.controls.length - 1" class="btn-icon plus" type="button" [title]="'titleAdd' | translate"
                    (click)="upSigner(index)" [innerHTML]="'common.icon.up' | translate">
                  </button>
                  <button *ngIf="index != formSigner.controls.length - 1 && index != formSigner.controls.length - 2" class="btn-icon plus" type="button"
                    [title]="'titleAdd' | translate" (click)="downSigner(index)"
                    [innerHTML]="'common.icon.down' | translate" >
                  </button>
                </td>
                <td class="vt-align-center">
                  <button class="btn-icon plus" type="button" [title]="'titleAdd' | translate"
                    (click)="addSigner(index)" [innerHTML]="'common.icon.plus' | translate">
                  </button>
                  <button class="btn-icon minus" [disabled]="item.value.isDefaultValue ? true : null" type="button" [title]="'titleDelete' | translate"
                    (click)="removeSigner(index)" [innerHTML]="'common.icon.minus' | translate">
                  </button>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
      <!--  -->
      <div class="panel panel-default">
        <div class="panel-heading">
          <strong class="text-u-c"><i class="fa fa-th"></i>&nbsp;{{'vofficeSign.label.listSignDocument' | translate}}</strong>
        </div>
        <div class="panel-body panel-table">
          <p-table [scrollable]="true" [value]="formSignerDocument.controls" #dataTable
            tableStyleClass="table controls-table table-wrapper b-t b-b" [(first)]="resultList.first"
            [paginator]="true" (onPage)="fetchDataSign($event)" [rows]="resultList.rows"
            [lazy]="true" [totalRecords]="resultList.recordsTotal"
          >
            <ng-template pTemplate="colgroup" let-columns>
              <colgroup>
                <col class="size-2">
                <col class="size-6">
                <col class="size-6 required">
                <col class="size-9 required">
              </colgroup>
            </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <th translate>common.table.index</th>
                <th translate><span>evaluatestaffprocess</span></th>
                <th class="required" translate><span>vofficeSign.label.resultVersionSign</span></th>
                <th class="required" translate>app.requestResolutionMonth.extractingTextContent</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item let-index="rowIndex">
              <tr [formGroup]="item">
                <td class="vt-align-center">
                  {{index+1}}
                </td>
                <td>
                  {{item.value.employeeCode}}_{{item.value.employeeName}}
                </td>
                <td>
                    <div *ngFor="let file of item.value.fileAttachment.listFiles">
                      <a style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis; max-width: 340px; display: block; overflow: hidden"
                        (click)="previewFile(file)">{{file.fileName}}</a>
                    </div>
                </td>
                <td class="vt-align-left">
                  <input type="text" class="form-control" formControlName="extractingTextContent">
                  <app-control-messages [control]="item.controls.extractingTextContent"></app-control-messages>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr class="emptymessage">
                <td [attr.colspan]="11" [innerHTML]="'app.noRecords' | translate">
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="paginatorleft">
              <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
            </ng-template>
          </p-table>
        </div>
        <div class="panel-footer vt-area-button">
          <button type="button" (click)="onClose();" class="btn btn-sm btn-danger"
          [innerHTML]="'common.button.close1' | translate"></button>
          <button type="submit" (click)="preview();"
            class="btn btn-sm btn-info" [innerHTML]="'common.button.table.preview' | translate">
          </button>
          <button  type="submit" (click)="onSignature();"
            class="btn btn-sm btn-info">
            <span class="glyphicons glyphicons-direction"></span>&nbsp;
            <ng-template *ngIf="isSignAll;then sign_all else sign"></ng-template>
            <ng-template #sign_all>
              <span [innerHTML]="'button.signAll' | translate"></span>
            </ng-template>
            <ng-template #sign>
              <span [innerHTML]="'button.sign' | translate"></span>
            </ng-template>
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
