<form id="formPosition" [formGroup]="formPosition">
  <div class="panel panel-default card-info">
    <div class="panel-heading vt-relative">
      <strong>
        <span translate> app.settings.mappingPosition.listTitle </span>
      </strong>
    </div>
    <div class="panel-body panel-table" style="padding: 0 12px 12px 12px;">
      <p-table
        [value]="formPosition.controls"
        [scrollable]="true"
        tableStyleClass="table controls-table table-wrapper b-t b-b"
        [resizableColumns]="true"
        styleClass="rewardGroupMinHeight"
        (sortFunction)="customSort($event)"
        [customSort]="true"
      >
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup class="ng-star-inserted">
            <col style="width: 50px;">
            <col style="width: 200px;">
            <col style="width: 200px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
            <col style="width: 100px;">
            <col style="width: 100px;" *ngIf="!view">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th translate pResizableColumn><span>common.table.index</span></th>
            <th translate pResizableColumn><span
                [ngClass]="{'required': formPosition.controls[0] && formPosition.controls[0].controls.massOrganizationId.isRequire}">massMember.organization</span>
            </th>
            <th translate pResizableColumn><span
                [ngClass]="{'required': formPosition.controls[0] && formPosition.controls[0].controls.massPositionId.isRequire}">massMember.massPosition</span>
            </th>
            <th translate pResizableColumn><span [ngClass]="{'required': formPosition.controls[0] && formPosition.controls[0].controls.effectiveDate.isRequire}">generalStandard.effectiveDate</span></th>
            <th translate pResizableColumn>generalStandard.expiredDate</th>
            <th translate pResizableColumn>label.mass.titlemgmt.isHighestTitle</th>
            <th translate pResizableColumn *ngIf="!view">
              <button class="btn-icon plus" type="button" (click)="add()" [innerHTML]="'common.icon.plus' | translate">
              </button>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex">
          <tr [formGroup]="item">
            <td class="vt-align-center">
              {{index+1}}
            </td>
            <td>
              <mass-org-selector [property]="item.controls.massOrganizationId" operationKey="action.view"
                adResourceKey="resource.massMember" [defaultValue]="true" [branch]="branch" [disabled]="view"
                [autoFocus]="true" [isRequiredField]="true" (onChange)="onChangeMassOrg($event, massOrgSelector)">
              </mass-org-selector>
              <app-control-messages [control]="item.controls.massOrganizationId"></app-control-messages>
            </td>
            <td>
              <data-picker [property]="item.controls.massPositionId" systemCode="political" operationKey="action.view"
                adResourceKey="resource.massMember" objectBO="MassPositionBO" codeField="code" nameField="name"
                selectField="massPositionId" [disabled]="view" [filterCondition]="filterCondition"
                [orderField]="orderField" [isRequiredField]="true" (onChange)="onChangePosition($event, item)"
                [nameData]="nameData">
              </data-picker>
              <app-control-messages [control]="item.controls.massPositionId"></app-control-messages>
            </td>
            <td>
              <date-picker [property]="item.controls.effectiveDate" appendTo="body">
              </date-picker>
              <app-control-messages [control]="item.controls.effectiveDate"></app-control-messages>
            </td>
            <td>
              <date-picker [property]="item.controls.expiredDate" appendTo="body">
              </date-picker>
              <app-control-messages [control]="item.controls.expiredDate"></app-control-messages>
            </td>
            <td class="vt-align-center">
              <label class="i-checks" *ngIf="!view">
                <input type="checkbox" name="isHighest" formControlName="isHighest"
                  (change)="setHighest(item, $event.target.value)" />
                <i></i>
              </label>
              <i class="fa fa-check color-info" *ngIf="item.controls.isHighest.value === 1 && view"></i>
            </td>
            <td class="vt-align-center" *ngIf="!view">
              <button class="btn-icon minus" type="button" (click)="remove(index)"
                [innerHTML]="'common.icon.minus' | translate">
              </button>
              <button class="btn-icon plus" *ngIf="item.controls.sortOrder.value > 1" type="button" (click)="goUp(item)"
                [innerHTML]="'common.icon.up' | translate">
              </button>
              <button class="btn-icon plus" *ngIf="item.controls.sortOrder.value < numIndex" type="button"
                (click)="goDown(item)" [innerHTML]="'common.icon.down' | translate">
              </button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</form>