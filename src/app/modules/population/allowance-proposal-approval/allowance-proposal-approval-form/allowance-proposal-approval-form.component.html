<div class="card-reward">
  <div class="clearfix">
    <div class="left-nav-bar pull-left row-header">
      <div>
        <img alt="back" class="img-fluid" src="./../../../../../../assets/images/home/Mask_Group_18824.png" (click)="goBack();">
        <span *ngIf="create" class="title" > Thêm mới đề xuất trợ cấp</span>
        <span *ngIf="update" class="title" > Cập nhật đề xuất trợ cấp</span>
        <span *ngIf="view" class="title" > Xem chi tiết đề xuất trợ cấp</span>
      </div>
    </div>
    <div class="right-nav-bar pull-right left-option">
      <ul class="header-right sys-ul space-line">
        <li>
          <button class="btn btn-sm vt-btn ng-star-inserted" type="button" (click)="goBack();" [innerHTML]="'common.button.out' | translate">
          </button>
        </li>
        <li *ngIf="!view">
          <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="processSaveOrUpdate(0)" [innerHTML]="'common.button.icon.save' | translate">
          </button>
        </li>
        <li *ngIf="!view">
          <button class="btn btn-sm vt-btn btn-submit ng-star-inserted" type="button" (click)="processSaveOrUpdate(1)" [innerHTML]="'common.button.icon.completePropose' | translate">
          </button>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class="info">
  <form id="formSave" [formGroup]="formSave">
    <div class="panel panel-default card-info">
      <div class="panel-heading">
        <strong>
          <span class="ml-2 title-info">Thông tin xét chọn đề xuất trợ cấp</span>
        </strong>
      </div>
      <div class="panel-body padding-xl ui-g">
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
            {{'subsidizedSuggest.label.subsidizedPeriodId' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <select-filter [property]="f['allowancePeriodId']" [options]="AllowancePeriodList" (onChange)="changeAllowancePeriod()" optionLabel="name" optionValue="allowancePeriodId"
                           [placeHolder]="'common.label.cboMustSelect'" [disabled]="true">
            </select-filter>
            <app-control-messages [control]="f['allowancePeriodId']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
            {{'label.welfare.policy.category.organizationModel' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <select-filter [property]="f['orgType']" [options]="orgTypeOptions" optionLabel="name" optionValue="id"
                           [placeHolder]="'common.label.cboMustSelect'"  [disabled]="true">
            </select-filter>
            <app-control-messages [control]="f['orgType']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
            {{'label.allowance.proposal.search.name' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <input type="text" class="form form-control" name="name" formControlName="name"
                   maxlength="200" [attr.disabled]="true">
            <app-control-messages [control]="f['name']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
            {{'label.allowance.period.search.allowanceType' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <select-filter [property]="f['allowanceType']" [options]="allowanceTypeOptions" optionLabel="name" optionValue="value"
                           [placeHolder]="'common.label.cboMustSelect'"  [disabled]="true">
            </select-filter>
            <app-control-messages [control]="f['allowanceType']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
            {{'label.allowance.proposal.search.proposeOrgId' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <mass-org-selector
                    [property]="f['proposeOrgId']"
                    operationKey="action.view"
                    adResourceKey="resource.allowanceProposalApproval"
                    [defaultValue]="true"
                    [branch] = "3"
                    [disabled]="true"
                    (onChange)="changeProposeOrgId()">
            </mass-org-selector>
            <app-control-messages [control]="f['proposeOrgId']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
            {{'label.allowance.proposal.search.approveOrgId' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <mass-org-selector
                    [property]="f['approveOrgId']"
                    operationKey="action.view"
                    adResourceKey="resource.allowanceProposalApproval"
                    [defaultValue]="true"
                    [branch] = "3"
                    [disabled]=" true">
            </mass-org-selector>
            <app-control-messages [control]="f['approveOrgId']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-5 ui-lg-2 control-label vt-align-right required">
            {{'label.welfare.policy.proposal.spendingOrg1' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <org-selector [property]="f['signOrgId']"
                          operationKey="action.view"
                          adResourceKey="resource.allowanceProposalApproval"
                          [defaultValue]="true"
                          [disabled]="true">
            </org-selector>
            <app-control-messages [control]="f['signOrgId']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-3 control-label vt-align-right">
            {{'common.label.attachmentFile' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <multi-file-chooser class="attachment-file" [property]="f['attachedFiles']" fileName="attachedFiles" [validMaxSize]="50"
                                validType="png,jpg,gif,tiff,bmp,xls,xlsx,doc,docx,pdf,rar,zip,7z"
                                [disabled]="true">
            </multi-file-chooser>
            <app-control-messages [control]="f['attachedFiles']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
            {{'rewardPropose.isSynthetic' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3 position-relative">
            <input type="checkbox" name="isSynthetic"  formControlName="isSynthetic" [attr.disabled]="true" style="width: 18px;
                height: 1.5rem;" [value]="0" (change)="onChangeSynthetic($event)">
          </div>
        </div>
      </div>
    </div>

    <div style="width: 100%;">
      <p-tabView class="tab-view">
        <p-tabPanel header="Danh sách chi tiết - Bản thân">
          <div class="scollTable panel panel-default" >
            <div class="panel-heading vt-relative">
              <strong>
                <span class="title">{{ 'rewardPropose.label.rewardDecide' | translate }}</span>
              </strong>
            </div>
            <div class="p-3">
              <div id="formSaveRewardDecide">
                <div class="panel-body panel-table" style="padding: 12px;">
                  <p-table [scrollable]="true" [value]="empAllowanceRequestBTBOList.controls" [paginator]="true" [resizableColumns]="true"
                           [first]="firstRowIndexBT" [rows]="pageSizeBT" [totalRecords]="empAllowanceRequestBTBOList ? empAllowanceRequestBTBOList.length : 0"
                           tableStyleClass="table table-wrapper table-hover table-striped b-t b-b">
                    <div class="tbl-panel">
                      <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                          <col style="width: 50px;">
                          <col style="width: 50px;">
                          <col style="width: 100px; display: none">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 50px;">
                          <col style="width: 150px;">
                        </colgroup>
                      </ng-template>
                      <ng-template pTemplate="header">
                        <tr>
                          <th pResizableColumn translate>common.table.index</th>
                          <th pResizableColumn translate><span>common.label.action</span></th>
                          <th pResizableColumn translate style="display: none"></th>
                          <th pResizableColumn translate>common.label.partymembersCode</th>
                          <th pResizableColumn translate>PartyMemberBO.memberName</th>
                          <th pResizableColumn translate>rewardGeneral.workunit</th>
                          <th pResizableColumn translate>subsidizedSuggest.label.subsidizedPeriodId</th>
                          <th pResizableColumn translate>label.welfare.policy.request.requestContent</th>
                          <th pResizableColumn translate>label.welfare.policy.desease.category</th>
                          <th pResizableColumn translate>label.allowance.request.search.reason</th>
                          <th pResizableColumn translate>label.welfare.policy.proposal.total</th>
                          <th pResizableColumn translate>label.rewardPropose.isChoose</th>
                          <th pResizableColumn translate>common.label.reason</th>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="body" let-item let-index="rowIndex">
                        <tr [formGroup]="item">
                          <td class="vt-align-center">
                            {{index+1}}
                          </td>
                          <td class="vt-align-center">
                            <div ngbDropdown class="d-inline-block" *ngIf="item.value.empAllowanceRequestId">
                              <div ngbDropdownToggle class="vt-action-hover">
                                <img class="menu-icon" src="./../../../assets/images/home/Icon.svg">
                              </div>
                              <div ngbDropdownMenu class="vt-border-radius">
                                <!-- View detail -->
                                <div>
                                  <button class="dropdown-item" (click)="viewDetailEmpAllowanceRequest(item)"
                                          [innerHTML]="'common.button.table.viewdropdown' | translate">
                                  </button>
                                </div>

                                  <div>
                                      <button class="dropdown-item" (click)="editDetailEmpAllowanceRequest(item)"
                                              [innerHTML]="'common.button.table.edit' | translate">
                                      </button>
                                  </div>
                              </div>
                            </div>
                          </td>
                          <td class="vt-align-left" style="display: none">
                            {{item.value.empAllowanceRequestId}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.employeeCode}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.employeeName}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.orgName}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.allowancePeriod}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.content}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.desease}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.reason}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.amountTotal}}
                          </td>
                          <td class="vt-align-left">
                            <input *ngIf="item.value.empAllowanceRequestId" type="checkbox" class="ui-chkbox ui-chkbox-box"
                                   name="isChoose" formControlName="isChoose" [value]="item.value.isChoose"
                                   [attr.disabled]="view? true: null" >
                          </td>
                          <td class="vt-align-left">
                            <input *ngIf="item.value.empAllowanceRequestId" type="text" [value]="item.value.reasonApprove" name="reasonApprove" formControlName="reasonApprove" [attr.disabled]="view? true: null">
                          </td>
                        </tr>
                      </ng-template>
                    </div>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
        </p-tabPanel>
        <p-tabPanel header="Danh sách chi tiết - thân nhân">
          <div class="scollTable panel panel-default" >
            <div class="panel-heading vt-relative">
              <strong>
                <span class="title">{{ 'rewardPropose.label.rewardDecide' | translate }}</span>
              </strong>
            </div>
            <div class="p-3">
              <div id="formSaveRewardDecide">
                <div class="panel-body panel-table" style="padding: 12px;">
                  <p-table [scrollable]="true" [value]="empAllowanceRequestNTBOList.controls" [paginator]="true" [resizableColumns]="true"
                           [first]="firstRowIndexNT" [rows]="pageSizeNT" [totalRecords]="empAllowanceRequestNTBOList ? empAllowanceRequestNTBOList.length : 0"
                           tableStyleClass="table table-wrapper table-hover table-striped b-t b-b">
                    <div class="tbl-panel">
                      <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                          <col style="width: 50px;">
                          <col style="width: 50px;">
                          <col style="width: 100px; display: none">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 100px;">
                          <col style="width: 50px;">
                          <col style="width: 150px;">
                        </colgroup>
                      </ng-template>
                      <ng-template pTemplate="header">
                        <tr>
                          <th pResizableColumn translate>common.table.index</th>
                          <th pResizableColumn translate><span>common.label.action</span></th>
                          <th pResizableColumn translate style="display: none"></th>
                          <th pResizableColumn translate>common.label.partymembersCode</th>
                          <th pResizableColumn translate>PartyMemberBO.memberName</th>
                          <th pResizableColumn translate>rewardGeneral.workunit</th>
                          <th pResizableColumn translate>subsidizedSuggest.label.subsidizedPeriodId</th>
                          <th pResizableColumn translate>label.welfare.policy.category.relationship</th>
                          <th pResizableColumn translate>label.welfare.policy.requestList.objectName</th>
                          <th pResizableColumn translate>label.welfare.policy.request.requestContent</th>
                          <th pResizableColumn translate>label.welfare.policy.desease.category</th>
                          <th pResizableColumn translate>label.allowance.request.search.reason</th>
                          <th pResizableColumn translate>label.welfare.policy.proposal.total</th>
                          <th pResizableColumn translate>label.rewardPropose.isChoose</th>
                          <th pResizableColumn translate>common.label.reason</th>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="body" let-item let-index="rowIndex">
                        <tr [formGroup]="item">
                          <td class="vt-align-center">
                            {{index+1}}
                          </td>
                          <td class="vt-align-center">
                            <div ngbDropdown class="d-inline-block" *ngIf="item.value.empAllowanceRequestId">
                              <div ngbDropdownToggle class="vt-action-hover">
                                <img class="menu-icon" src="./../../../assets/images/home/Icon.svg">
                              </div>
                              <div ngbDropdownMenu class="vt-border-radius">
                                <!-- View detail -->
                                <div>
                                  <button class="dropdown-item" (click)="viewDetailEmpAllowanceRequest(item)"
                                          [innerHTML]="'common.button.table.viewdropdown' | translate">
                                  </button>

                                </div>
                                  <div>
                                      <button class="dropdown-item" (click)="editDetailEmpAllowanceRequest(item)"
                                              [innerHTML]="'common.button.table.edit' | translate">
                                      </button>
                                  </div>
                              </div>
                            </div>
                          </td>
                          <td class="vt-align-left" style="display: none">
                            {{item.value.empAllowanceRequestId}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.employeeCode}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.employeeName}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.orgName}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.allowancePeriod}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.relationShip}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.objectName}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.content}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.desease}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.reason}}
                          </td>
                          <td class="vt-align-left">
                            {{item.value.amountTotal}}
                          </td>
                          <td class="vt-align-left">
                            <input *ngIf="item.value.empAllowanceRequestId" type="checkbox" name="isChoose" [value]="1" formControlName="isChoose" [attr.disabled]="view? true: null" style="width: 18px;height: 1.5rem;" >
                          </td>
                          <td class="vt-align-left">
                            <input *ngIf="item.value.empAllowanceRequestId" type="text" name="reasonApprove" [value]="item.value.reasonApprove" formControlName="reasonApprove" [attr.disabled]="view? true: null">
                          </td>
                        </tr>
                      </ng-template>
                    </div>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
        </p-tabPanel>
      </p-tabView>
    </div>
  </form>
</div>
