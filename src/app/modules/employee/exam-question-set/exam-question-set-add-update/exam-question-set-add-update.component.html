<div class="card-form">
  <div class="clearfix">
    <div class="left-nav-bar pull-left row-header">
      <div>
        <img alt="back" class="img-fluid" src="./../../../../../../assets/images/home/Mask_Group_18824.png"
          (click)="previous()">
        <span class="title">{{header}}</span>
      </div>
    </div>
    <div class="right-nav-bar pull-right left-option">
      <ul class="header-right sys-ul space-line">
        <li>
          <button class="btn btn-sm vt-btn mt-btn ng-star-inserted" type="button" (click)="previous()"
            [innerHTML]="'common.button.close' | translate">
          </button>
        </li>

        <li *ngIf="!viewMode">
          <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" [disabled]="isApproved" (click)="approve()"
            [innerHTML]="'common.button.icon.approve' | translate">
          </button>
        </li>

        <li *ngIf="!viewMode">
          <button class="btn btn-sm vt-btn btn-submit mt-btn ng-star-inserted" type="button" (click)="save()"
            [innerHTML]="'common.button.icon.save' | translate">
          </button>
        </li>
        <!-- <li *ngIf="!viewMode">
          <button class="btn btn-sm vt-btn btn-submit mt-btn btn-header-right ng-star-inserted" type="button"
            (click)="navigate()" [innerHTML]="'common.button.icon.edit' | translate">
          </button>
        </li> -->
      </ul>
    </div>
  </div>
</div>
<div class="info">
  <form id="formSave" [formGroup]="formGroup">
    <div class="panel panel-default card-info card-search">
      <div class="panel-heading">
        <strong>
          <!-- {{header}} -->
          <span class="ml-2 title-info">Thêm mới bộ câu hỏi</span>
        </strong>
      </div>
      <div *ngIf="!isMobileScreen" class="panel-body padding-xl ui-g border-info-common" style="padding-bottom: 32px">
        <!--        row 1-->
        <div class="ui-g-12 vt-row">
          <!--            tiêu đề -->
          <label class="ui-g-12 ui-md-12 ui-lg-2 control-label vt-align-right required">
            {{'label.exam.question.set.title' | translate}}</label>
          <div class="ui-g-12 ui-md-12 ui-lg-3">
            <input type="text" [attr.disabled]="viewMode?true:null" formControlName="title" class="form-control">
            <app-control-messages [control]="f['title']"></app-control-messages>
          </div>
            <!-- Lĩnh vực -->
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
                {{'label.exam.question.set.branch' | translate}}</label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
                <p-dropdown [formControl]="f['branch']" [disabled]="viewMode ? true : false"
                            [options]="branchList" [placeholder]="'placeholder.choose' | translate" [showClear]="true"></p-dropdown>
                <app-control-messages [control]="f['branch']"></app-control-messages>
            </div>
        </div>

        <!--        row 2-->
        <div class="ui-g-12 vt-row">
          <!--            Trạng thái  -->
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
            {{'label.exam.question.set.status' | translate}}</label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <p-dropdown [optionLabel]="'name'" [formControl]="f['status']" [disabled]="1"
              [options]="statusList" [placeholder]="'placeholder.choose' | translate" [showClear]="true"></p-dropdown>
            <app-control-messages [control]="f['status']"></app-control-messages>
          </div>
        </div>
      </div>
    </div>
    <div class="panel panel-default card-info" style="padding-bottom: 15px">
      <div class="panel-heading vt-relative">
        <strong>
          <span>{{'label.settings.lstQuestion' | translate}}</span>
        </strong>
      </div>

      <div class="table-wrapper table-responsive" style="margin-top: 4px; padding-bottom: 15px;">
        <p-table [value]="formGroup.value.listExamQuestion" styleClass="controlOverflow" [(selection)]="selectedItems" [paginator]="true"
          (onPage)="pageChange($event)" [paginator]="resultList.data && resultList.data.length" [first]="first" [rows]="rows"
          [totalRecords]="formGroup.value.listExamQuestion.length"
          tableStyleClass="table controls-table table-wrapper b-t b-b" [resizableColumns]="true">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th [style.width]="'50px'"></th>
              <th [style.width]="'50px'"></th>
              <th *ngFor="let col of columnsExamQuestion" [style.width]="col.width" style="text-align: center;" pResizableColumn>
                {{ col.header | translate }}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columnsExamQuestion" let-rowIndex="rowIndex">
            <tr>
              <td class="vt-align-center" style="overflow: inherit !important;">
                <div ngbDropdown class="d-inline-block">
                  <div ngbDropdownToggle class="vt-action-hover">
                    <img class="menu-icon" src="./../../../assets/images/home/Mask_Group_24366.png">
                  </div>
                  <div ngbDropdownMenu class="vt-border-radius">
                    <!-- Xem chi tiết -->
                    <button class="dropdown-item" (click)="viewAnswer(rowData)" 
                      [innerHTML]="'common.button.table.viewdropdown' | translate">
                    </button>
                    <!-- Sửa -->
                    <button class="dropdown-item" (click)="updateAnswer(rowData, rowIndex)" *ngIf="viewMode ? false : true"
                      [innerHTML]="'common.button.table.acteditdropdown' | translate">
                    </button>
                    <!-- Xóa -->
                    <button class="dropdown-item" (click)="deleteAnswer(rowData, rowIndex)" *ngIf="viewMode ? false : true"
                      [innerHTML]="'common.button.icon.delete' | translate">
                    </button>
                  </div>
                </div>
              </td>
              <td>
                <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
              </td>
              <td *ngFor="let col of columnsExamQuestion" class="ui-resizable-column {{col.cssClass}}">
                <span *ngIf="col.field == 'no'">{{ rowData[col.field] }}</span>
                <textarea *ngIf="col.field != 'no'" style="width: 100%; text-overflow: ellipsis;" pInputText
                  class="form-control" [value]="rowData[col.field]" readonly="true"></textarea>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="paginatorleft">
            <div class="footer-wrapper">
              <div class="table-footer-sumary">
                  <label>
                    {{'common.tableSumary.findAll' | translate}} : <span class="total-record">{{formGroup.value.listExamQuestion.length}}</span>
                  </label>
              </div>
              <div [ngClass]="{'none': totalWidth}" class="item-right">
                  <label id="label">Hiển thị </label>
                  <p-dropdown class="dropdown-1" [options]="rowOptions" optionLabel="label" (onChange)="onChangeOption($event)"> </p-dropdown>
                  <div id="vt-div"> </div>
              </div>
          </div>
        </ng-template>
        </p-table>
        <div class="vt-area-button ui-g" style="padding-top: 10px;">
          <!-- <span *ngIf="!isView" style="cursor: pointer; color: #00A3F3;" (click)="addRiskManagement()" translate>app.qlrr.plus</span>
          <span *ngIf="!isView" style="cursor: pointer; color: #00A3F3;" (click)="openImportRickManagement()" translate>app.qlrr.import</span> -->
          <button type="submit" (click)="addExamQuestion()" class="btn btn-sm btn-info" style="margin-right: 10px;"
          *ngIf="!viewMode" [innerHTML]="'common.button.icon.addQuestion' | translate"><i class="fa fa-save"></i></button>

          <button type="submit" (click)="deleteExamQuestion()" class="btn btn-sm btn-info" style="margin-right: 10px;"
          *ngIf="!viewMode" [innerHTML]="'common.button.icon.deleteQuestion' | translate"><i class="fa fa-save"></i></button>

          <button  type="button" class="btn btn-sm vt-btn" (click)="openFormImport()" *ngIf="viewMode ? false : true"
          [innerHTML]="'common.button.icon.ImportData' | translate"></button>
        </div>
      </div>

    </div>
  </form>
</div>
