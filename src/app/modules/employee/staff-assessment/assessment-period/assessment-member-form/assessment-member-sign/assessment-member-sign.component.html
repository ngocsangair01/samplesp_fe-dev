<div class="content vt-nopadding">
    <div class="no-padding-left">
        <div class="panel-default">
            <div class="panel-heading vt-relative">
                <strong>
                    {{'assessmentPartyOrg.import.title' | translate}}
                </strong>
                <div class="vt-absolute vt-shotcut-button-in-heading">
                    <button (click)="activeModal.close()" title="{{'common.button.close' | translate}}"
                      class="btn btn-span btn-sm"><img class="info-icon" src="./../../../../../../assets/images/home/Mask_Group_19561.png"></button>
                </div>
            </div>
            <form id="formSign" [formGroup]="formSign">
                <div *ngIf="!isMobileScreen" class="panel-body padding-xl ui-g">
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.assessmentPeriodName' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-lg-3">
                            <select-filter [property]="f['assessmentPeriodId']" [options]="assessmentList"
                                optionLabel="assessmentPeriodName" optionValue="assessmentPeriodId"
                                [placeHolder]="'placeholder.choose'" [disabled]="true">
                            </select-filter>
                            <app-control-messages [control]="f['assessmentPeriodId']"></app-control-messages>
                        </div>
                        <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.partyOrg' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-lg-3">
                            <party-org-selector [property]="f['partyOrganizationId']" operationKey="action.view"
                                adResourceKey="resource.assessmentPeriod" [defaultValue]="false" [isRequiredField]="false">
                            </party-org-selector>
                            <app-control-messages [control]="f['partyOrganizationId']"></app-control-messages>
                        </div>

                    </div>
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.assessmentLevel' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-lg-3">
                            <select-filter [property]="f['assessmentOrder']" [options]="assessmentLevelList"
                                optionLabel="assessmentLevelName" optionValue="assessmentOrder"
                                [placeHolder]="'placeholder.choose'">
                            </select-filter>
                            <app-control-messages [control]="f['assessmentOrder']"></app-control-messages>
                        </div>
                        <!--   Nguoi ky kqdg         -->
                        <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
                            {{'assessment.evaluating.signer' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-lg-3">
                            <data-picker #data [property]="f['signerId']" systemCode="assessment" operationKey="action.view"
                                adResourceKey="resource.assessmentPeriod" objectBO="AllEmployeeBO" codeField="employeeCode"
                                nameField="fullName" emailField="email" mobileNumberField="mobileNumber"
                                selectField="employeeId" filterCondition="" [disabled]="">
                            </data-picker>
                            <app-control-messages [control]="f['signerId']"></app-control-messages>
                        </div>
                    </div>
                </div>
                <div *ngIf="isMobileScreen" class="panel-body padding-xl ui-g">
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-6 ui-sm-3 ui-lg-2 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.assessmentPeriodName' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-sm-9 ui-lg-3">
                            <select-filter [property]="f['assessmentPeriodId']" [options]="assessmentList"
                                optionLabel="assessmentPeriodName" optionValue="assessmentPeriodId"
                                [placeHolder]="'placeholder.choose'" [disabled]="true">
                            </select-filter>
                            <app-control-messages [control]="f['assessmentPeriodId']"></app-control-messages>
                        </div>
                    </div>
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-6 ui-sm-3 ui-lg-3 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.partyOrg' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-sm-9 ui-lg-3">
                            <party-org-selector [property]="f['partyOrganizationId']" operationKey="action.view"
                                adResourceKey="resource.assessmentPeriod" [defaultValue]="false" [isRequiredField]="false">
                            </party-org-selector>
                            <app-control-messages [control]="f['partyOrganizationId']"></app-control-messages>
                        </div>

                    </div>
                    <div class="ui-g-12 vt-row">
                        <label class="ui-g-12 ui-md-6 ui-sm-3 ui-lg-2 control-label vt-align-right required">
                            {{'assessmentPartyOrg.import.assessmentLevel' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-sm-9 ui-lg-3">
                            <select-filter [property]="f['assessmentOrder']" [options]="assessmentLevelList"
                                optionLabel="assessmentLevelName" optionValue="assessmentOrder"
                                [placeHolder]="'placeholder.choose'">
                            </select-filter>
                            <app-control-messages [control]="f['assessmentOrder']"></app-control-messages>
                        </div>
                    </div>
                    <div class="ui-g-12 vt-row">
                        <!--   Nguoi ky kqdg         -->
                        <label class="ui-g-12 ui-md-6 ui-sm-3 ui-lg-3 control-label vt-align-right">
                            {{'assessment.evaluating.signer' | translate}}
                        </label>
                        <div class="ui-g-12 ui-md-6 ui-sm-9 ui-lg-3">
                            <data-picker #data [property]="f['signerId']" systemCode="assessment" operationKey="action.view"
                                adResourceKey="resource.assessmentPeriod" objectBO="AllEmployeeBO" codeField="employeeCode"
                                nameField="fullName" emailField="email" mobileNumberField="mobileNumber"
                                selectField="employeeId" filterCondition="" [disabled]="">
                            </data-picker>
                            <app-control-messages [control]="f['signerId']"></app-control-messages>
                        </div>
                    </div>
                </div>
                <div class="panel-footer vt-area-button">
                    <button type="submit" (click)="processSearchEmployee()" class="btn btn-sm vt-btn btn-submit"
                        [innerHTML]="'common.button.icon.viewData' | translate"></button>
                    <button type="button" (click)="openSign(assessmentEmployeeList)" class="btn btn-sm vt-btn btn-submit"
                        [innerHTML]="'common.button.actSign' | translate"></button>
                </div>
                <div class="panel-body panel-table">
                    <p-table #ptable [value]="assessmentEmployeeList.data" [paginator]="true" [lazy]="true" [rows]="changeRow" [scrollable]="true"
                        [totalRecords]="assessmentEmployeeList.recordsTotal"
                        tableStyleClass="table table-wrapper table-hover table-striped b-t b-b"
                        [resizableColumns]="true"
                        styleClass="controlOverflow">
                        <ng-template pTemplate="colgroup" let-columns>
                            <colgroup class="ng-star-inserted">
                                <col style="width: 50px;">
                                <col style="width: 200px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 200px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                                <col style="width: 100px;">
                            </colgroup>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th translate pResizableColumn>common.table.index</th>
                                <th [pSortableColumn]="'employeeCode'" pResizableColumn>
                                    {{'assessmentPeriod.assessmentEmployeeList.employee' | translate}}
                                    <p-sortIcon [field]="'employeeCode'"></p-sortIcon>
                                </th>
                                <th pResizableColumn>
                                    {{'assessmentPeriod.assessmentEmployeeList.position' | translate}}
                                    <p-sortIcon [field]="'employeePositionName'"></p-sortIcon>
                                </th>
                                <th pResizableColumn>{{'common.label.unit' | translate}}</th>
                                <th pResizableColumn>{{'partymanager.label.partyTitle' | translate}}</th>
                                <th pResizableColumn>{{'organization.label.name' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.levelListMapping' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.viewFileVO' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentLevelList.evaluatingLevel' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentLevelList.assessmentResultStatus' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentLevelList.assessmentDeadlineDate' | translate}}</th>
                                <th pResizableColumn>{{'assessmentPeriod.assessmentLevelList.assessmentCompleteDate' | translate}}</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-item let-index="rowIndex+1">
                            <tr>
                                <td class="vt-align-center">{{index}}</td>
                                <td class="vt-align-left text-break">
                                    <ul>
                                        <li><span>{{item.employeeName}}</span></li>
                                        <li><span>{{item.employeeCode}}</span></li>
                                        <li><span>{{item.employeeEmail}}</span></li>
                                    </ul>
                                </td>
                                <td class="vt-align-left">
                                    {{item.employeePositionName}}
                                </td>
                                <td class="vt-align-left">
                                    {{item.organizationName}}
                                </td>
                                <td class="vt-align-left">
                                    {{item.employeePartyPosition}}
                                </td>
                                <td class="vt-align-left">
                                    {{item.employeePartyOrganization}}
                                </td>

                                <td class="vt-align-left text-break">
                                    <ul>
                                        <li *ngFor="let data of item.levelNameEmployeeList; index as idx">
                                            <span *ngIf="data.assessmentOrder < item.assessmentOrder2"
                                                (click)="viewFileSign(item.signDocumentId)"
                                                title="{{'assessment.evaluating.nextstaff' | translate}}"
                                                style="font-weight: bold;color: #13C3DB;">{{data.levelNameEmployeeMapping}}</span>
                                            <span *ngIf="data.assessmentOrder == item.assessmentOrder2"
                                                title="{{'assessment.evaluating.nextstaff' | translate}}"
                                                style="font-weight: bold;color: #0B5178;">{{data.levelNameEmployeeMapping}}</span>
                                            <span
                                                *ngIf="data.assessmentOrder > item.assessmentOrder2">{{data.levelNameEmployeeMapping}}</span>
                                        </li>
                                        <!-- <a style="color: #0943B5;" (click)="setupEmployeeAssessment(item.employeeId, true)">
                                            {{'assessmentPeriod.assessmentEmployeeList.addEmployee' | translate}}
                                        </a> -->
                                    </ul>
                                </td>
                                <td class="vt-align-center">
                                    <a class="btn-table eye" (click)="preview(item)"
                                        title="{{'assessment.button.table.hEye' | translate}}"><i
                                            class="fa fa-eye color-info"></i></a>
                                </td>
                                <td class="vt-align-left">
                                    {{item.evaluatingLevelName}}
                                </td>
                                <td class="vt-align-left">
                                    <span *ngIf="item.assessmentResultStatus == 0">Dự Thảo</span>
                                    <span *ngIf="item.assessmentResultStatus == 1">Đang trình ký</span>
                                    <span *ngIf="item.assessmentResultStatus == 2">Từ chối ký duyệt</span>
                                    <span *ngIf="item.assessmentResultStatus == 3">Đã ký duyệt</span>
                                    <span *ngIf="item.assessmentResultStatus == 4">Đã nộp</span>
                                </td>
                                <td class="vt-align-left">
                                    {{item.assessmentDeadlineDate | displayDate}}
                                </td>
                                <td class="vt-align-left">
                                    {{item.assessmentCompleteDate | displayDate}}
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr class="emptymessage">
                                <td [attr.colspan]="10" [innerHTML]="'app.noRecords' | translate">
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="paginatorleft">
                            <table-footer (changeRow)="onTablePageChange($event)" [resultList]="assessmentEmployeeList"></table-footer>
                        </ng-template>
                    </p-table>
                </div>
            </form>
        </div>
    </div>
</div>