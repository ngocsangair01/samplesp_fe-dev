<div class="content vt-nopadding">
  <div class="no-padding-left">
    <div class="panel panel-default">
      <div class="panel-heading">
        <strong>
          <span> {{'assessment.assessmentPeriodStaffTitleSearch' | translate}}</span>
        </strong>
        <div class="vt-absolute vt-shotcut-button-in-heading">
          <button (click)="activeModal.close()" title="{{'common.button.close' | translate}}"
            class="btn btn-span btn-sm"><img class="info-icon" src="./../../../../../../assets/images/home/Mask_Group_19561.png"></button>
        </div>
      </div>
      <form id="formSearch" [formGroup]="formSearch">
        <div class="panel-body padding-xl ui-g">
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'assessment.employeeCode' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input [autoFocus]="true" type="text" class="form form-control" name="employeeCode" formControlName="employeeCode" maxlength="100">
              <app-control-messages [control]="f['employeeCode']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'assessment.employeeName' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" name="employeeName" formControlName="employeeName" maxlength="200">
              <app-control-messages [control]="f['employeeName']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'assessment.positionName' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" name="employeePositionName"
                formControlName="employeePositionName" maxlength="200">
              <app-control-messages [control]="f['employeePositionName']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'document.label.organization'|translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector
              [property]="f['organizationId']"
              operationKey="action.view"
              adResourceKey="resource.document"
              [defaultValue]="true">
            </org-selector>
            <app-control-messages [control]="f['organizationId']"></app-control-messages>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'assessment.evaluating.employeeName' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" name="evaluatingLevelFullName"
                formControlName="evaluatingLevelFullName" maxlength="200">
              <app-control-messages [control]="f['evaluatingLevelFullName']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'assessment.partyOrg' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <party-org-selector 
                [property]="f['partyOrganizationId']"
                operationKey="action.view"
                adResourceKey="resource.assessmentPeriod"
                [defaultValue]="false"
                [isRequiredField]="false"
              >
              </party-org-selector>
              <app-control-messages [control]="f['partyOrganizationId']"></app-control-messages>
            </div>
          </div>
        </div>
        <div class="panel-footer vt-area-button" >
          <button type="submit" class="btn btn-sm vt-btn btn-submit" (click)="processSearchWithDomain()"  [innerHTML]="'common.button.icon.search' | translate" > </button>
          <button type="button" *hasPermission="[this, 'action.export']" class="btn btn-sm vt-btn" (click)="processExport()" [innerHTML]="'common.button.icon.exportFile' | translate"> </button>
          <button type="button" *hasPermission="[this, 'action.export']" class="btn btn-sm vt-btn" (click)="processExportRs()" [innerHTML]="'common.header.export' | translate"> </button>
        </div>
      </form>
      <!--grid-->
      <div class="panel-heading vt-relative">
        <strong class="text-u-c">
          <i class="fa fa-th"></i>
          {{'assessment.assessmentPeriodStaffList' | translate}}
        </strong>
      </div>
      <div class="panel-body panel-table">
        <p-table
          #ptable
          [scrollable]="true"
          [value]="resultList.data"
          [paginator]="true"
          (onLazyLoad)="processSearchWithDomain($event)"
          [lazy]="true" [rows]="changeRow"
          [totalRecords]="resultList.recordsTotal"
          [lazyLoadOnInit]="false"
          tableStyleClass="table controls-table table-wrapper b-t b-b"
          [resizableColumns]="true" 
          styleClass="rewardGroupMinHeight"
        >
          <ng-template pTemplate="colgroup" let-columns>
            <colgroup class="ng-star-inserted">
              <col style="width: 50px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 200px;">
              <col style="width: 200px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
              <col style="width: 100px;">
            </colgroup>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th translate pResizableColumn>common.table.index</th>
              <th pResizableColumn>
                {{'assessmentPeriod.assessmentEmployeeList.imagePath' | translate}}
              </th>
              <th [pSortableColumn]="'employeeCode'" pResizableColumn>
                {{'assessmentPeriod.assessmentEmployeeList.employeeCode' | translate}}
                <p-sortIcon [field]="'employeeCode'"></p-sortIcon>
              </th>
              <th [pSortableColumn]="'employeeName'" pResizableColumn>
                {{'assessmentPeriod.assessmentEmployeeList.employeeName' | translate}}
                <p-sortIcon [field]="'employeeName'"></p-sortIcon>
              </th>
              <th [pSortableColumn]="'employeePositionName'" pResizableColumn>
                {{'assessmentPeriod.assessmentEmployeeList.position' | translate}}
                <p-sortIcon [field]="'employeePositionName'"></p-sortIcon>
              </th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.levelListMapping' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentLevelList.evaluatingLevel' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.delete' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.deleteResult' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.previewFile' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentEmployeeList.VO' | translate}}</th>
              <th pResizableColumn>{{'common.label.sign' | translate}}</th>
              <th pResizableColumn>{{'assessmentPeriod.assessmentLevelMappingCriteriaAgain' | translate}}</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item let-index="rowIndex+1">
            <tr>
              <td class="vt-align-center">{{index}}</td>
              <td class="vt-align-center">
                <img width="80px" height="80px" [title]="item.employeeName" [alt]="item.employeeName" [src]="AVATAR_API_URL + item.employeeCode"/>
              </td>
              <td class="vt-align-center">
                {{item.employeeCode}}
              </td>
              <td class="vt-align-left">
                {{item.employeeName}}
              </td>
              <td class="vt-align-left">
                {{item.employeePositionName}}
              </td>
              <td class="vt-align-left">
                <!-- <div *ngFor="let data of item.levelNameEmployeeList; index as idx">
                  {{data.levelNameEmployeeMapping}}
                </div> -->
                <ul>
                  <li *ngFor="let data of item.levelNameEmployeeList; index as idx">
                    <span *ngIf="data.assessmentOrder==(item.evaluatingLevel + 1)" title="{{'assessment.evaluating.nextstaff' | translate}}" style="font-weight: bold;">{{data.levelNameEmployeeMapping}}</span>
                    <span *ngIf="data.assessmentOrder!=(item.evaluatingLevel + 1)">{{data.levelNameEmployeeMapping}}</span>
                  </li>
  <!--                <li>-->
  <!--                  <a style="color: rgb(0, 153, 255);" (click)="setupEmployeeAssessment(item.employeeId)">-->
  <!--                    {{'assessmentPeriod.assessmentEmployeeList.addEmployee' | translate}}-->
  <!--                  </a>-->
  <!--                </li>-->
                </ul>
              </td>
              <td class="vt-align-left">
                {{bindingEvaluatingLevel(item)}}
              </td>
              <td class="vt-align-center">
  <!--              <div *ngIf="item.signStatus!=3"><span class="fa fa-trash color-error fa-lg btn-hover" *hasPermission="[this, 'action.delete', 'resource.employeeMapping']" (click)="deleteEmployee(item)" title="{{'common.button.table.hDelete' | translate}}"></span></div>-->
              </td>
              <td class="vt-align-center">
  <!--              <div *ngIf="item.signStatus!=3"><span class="fa fa-trash color-error fa-lg btn-hover" *hasPermission="[this, 'action.delete', 'resource.employeeMapping']" (click)="deleteResult(item)" title="{{'common.button.deleteAssessmentResult' | translate}}"></span></div>-->
              </td>
              <td class="vt-align-center">
                <div *ngIf="item.signStatus!=3"><span class="fa fa-eye color-error fa-lg btn-hover" (click)="exportAssessmentResult(item)" title="{{'assessment.criteria.export.file' | translate}}"></span></div>
              </td>
              <td class="vt-align-center">
                <span class="fa fa-download color-error fa-lg btn-hover" *ngIf="item.signStatus && item.signStatus==3" (click)="exportFileSign(item)" title="{{'assessment.criteria.export.fileSigned' | translate}}"></span>
              </td>
              <td class="vt-align-center">
  <!--              <div *ngIf="item.evaluatingLevel==item.maxEvaluatingLevel && item.signStatus!=3 && item.signStatus!=1"><span class="fas fa-paper-plane color-error fa-lg btn-hover" *hasPermission="[this, 'action.sign', 'resource.employeeMapping']" (click)="signature(item)" title="{{'common.label.sign' | translate}}"></span></div>-->
              </td>
              <td class="vt-align-center">
  <!--              <div *ngIf="item.signStatus!=3"></div><span class="fa fa-reply color-error fa-lg btn-hover" *hasPermission="[this, 'action.reevaluation', 'resource.employeeMapping']" (click)="processReEvaluateEmployee(item)" title="{{'assessmentPeriod.assessmentLevelMappingCriteriaAgain' | translate}}"></span>-->
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr class="emptymessage">
              <td [attr.colspan]="10" [innerHTML]="'app.noRecords' | translate">
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="paginatorleft">
            <table-footer (changeRow)="onTablePageChange($event)" [resultList]="resultList"></table-footer>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
</div>
