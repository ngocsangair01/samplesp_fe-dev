<div id="searchPage">
  <div id="searchArea">
    <div class="panel panel-default">
      <div class="panel-heading" translate>
        <strong class="text-u-c">
          <i class="fa fa-th"></i>
          common.label.search.info
        </strong>
      </div>
      <form id="formSearch" [formGroup]="formSearch">
        <div class="panel-body padding-xl ui-g">
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'common.label.unit' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <org-selector [property]="f['organizationId']" operationKey="action.view"
                adResourceKey="resource.empManagementVertical" [defaultValue]="true">
              </org-selector>
              <app-control-messages [control]="f['organizationId']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'managementVertical.year' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <select-filter [property]="f['year']" [options]="listYear" optionLabel="year" optionValue="year"
                [placeHolder]="'common.label.cboSelectAll'">
              </select-filter>
            </div>
          </div>
          <div class="ui-g-12 vt-row">
            <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
              {{'managementVertical.employeeCode' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" formControlName="employeeCode" maxlength="200"
                [autoFocus]="true">
              <app-control-messages [control]="f['employeeCode']"></app-control-messages>
            </div>
            <label class="ui-g-12 ui-md-6 ui-lg-3 control-label vt-align-right">
              {{'managementVertical.employeeName' | translate}}
            </label>
            <div class="ui-g-12 ui-md-6 ui-lg-3">
              <input type="text" class="form form-control" formControlName="employeeName" maxlength="200">
              <app-control-messages [control]="f['employeeName']"></app-control-messages>
            </div>
          </div>
        </div>
        <div class="panel-footer vt-area-button">
          <button *hasPermission="[this, 'action.view']" type="submit" class="btn btn-sm btn-info"
            (click)="processSearch()" [innerHTML]="'common.button.icon.search' | translate"></button>
          <button *hasPermission="[this, 'action.export']" type="button" class="btn btn-sm btn-info"
            (click)="prepareSaveOrUpdate()" [innerHTML]="'common.button.icon.addNew' | translate"> </button>
          <button type="button" class="btn btn-sm btn-info" (click)="processExport()"
            [innerHTML]="'common.button.icon.exportFile' | translate"></button>
          <button *hasPermission="[this, 'action.import']" type="button" class="btn btn-sm btn-info"
            (click)="processImport()" [innerHTML]="'managementVertical.button.import' | translate"></button>
        </div>
      </form>
    </div>
  </div>
</div>
<div id="listArea">
  <div class="panel panel-default">
    <div class="panel-heading vt-relative">
      <strong class="text-u-c">
        <i class="fa fa-th"></i>
        {{'managementVertical.list' | translate}}
      </strong>
    </div>
    <div class="panel-body panel-table">
      <p-table #ptable [value]="resultList.data" [paginator]="true" (onLazyLoad)="processSearch($event)" [lazy]="true"
        [rows]="changeRow" [totalRecords]="resultList.recordsTotal" [scrollable]="true" [lazyLoadOnInit]="false"
        tableStyleClass="table table-wrapper table-hover table-striped b-t b-b" styleClass="controlOverflow">
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col class="size-1">
            <col class="size-4">
            <col class="size-12">
            <col class="size-4">
            <col class="size-6">
            <col class="size-2">
            <col class="size-4">
            <col class="size-4">
            <col class="size-12">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th translate>common.table.index</th>
            <th translate>common.label.action</th>
            <th [pSortableColumn]="'orgFullName'">
              {{'common.label.unit'|translate}}
              <p-sortIcon [field]="'orgFullName'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'employeeCode'">
              {{'managementVertical.employeeCode'|translate}}
              <p-sortIcon [field]="'employeeCode'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'employeeName'">
              {{'managementVertical.employeeName'|translate}}
              <p-sortIcon [field]="'employeeName'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'year'">
              {{'managementVertical.year' | translate}}
              <p-sortIcon [field]="'year'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'isCommittee'">
              {{'managementVertical.isCommittee' | translate}}
              <p-sortIcon [field]="'isCommittee'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'isSolider'">
              {{'managementVertical.isSolider' | translate}}
              <p-sortIcon [field]="'isSolider'"></p-sortIcon>
            </th>
            <th [pSortableColumn]="'note'">
              {{'managementVertical.note' | translate}}
              <p-sortIcon [field]="'note'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex+1">
          <tr>
            <td class="vt-align-center">{{index}}</td>
            <td class="vt-align-center">
              <div ngbDropdown class="d-inline-block">
                <button class="btn btn-sm btn-info" ngbDropdownToggle translate>common.label.action</button>
                <div ngbDropdownMenu>
                  <!-- Sửa -->
                  <div *hasPermission="[this, 'action.update']">
                    <button class="dropdown-item" (click)="prepareSaveOrUpdate(item.empManagementVerticalId)"
                      [innerHTML]="'common.button.table.acteditdropdown' | translate">
                    </button>
                  </div>
                  <!-- Xóa -->
                  <div *hasPermission="[this, 'action.delete']">
                    <button class="dropdown-item" (click)="processDelete(item.empManagementVerticalId)"
                      [innerHTML]="'common.button.removedropdown' | translate">
                    </button>
                  </div>
                </div>
              </div>
            </td>
            <td class="vt-align-left">{{item.orgFullName}}</td>
            <td class="vt-align-center">{{item.employeeCode}}</td>
            <td class="vt-align-left">{{item.employeeName}}</td>
            <td class="vt-align-center">{{item.year}}</td>
            <td class="vt-align-center">
              <i *ngIf="item.isCommittee==1" class="fas fa-check table-icon color-info"></i>
            </td>
            <td class="vt-align-center">
              <i *ngIf="item.isSolider==1" class="fas fa-check table-icon color-info"></i>
            </td>
            <td class="vt-align-left">{{item.note}}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr class="emptymessage">
            <td [attr.colspan]="8" [innerHTML]="'app.noRecords' | translate">
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="paginatorleft">
          <table-footer (changeRow)="onTablePageChange($event)"  [resultList]="resultList"></table-footer>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>