<div id = "searchPage">
  <div id = "searchArea">
    <div class="panel panel-default">
      <div class="panel-heading">
        <strong class="text-u-c">
          <i class="fa fa-th"></i>
          {{'common.label.search.info' | translate}}
        </strong>
      </div>
    <form id="formSearch" [formGroup]="formSearch">
      <div class="panel-body padding-xl ui-g">
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
            {{'common.label.unit' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <org-selector
              [property]="f['organizationId']"
              operationKey="action.view"
              adResourceKey="resource.employeeManager"
              [defaultValue]="true">
            </org-selector>
            <app-control-messages [control]="f['organizationId']"></app-control-messages>
          </div>
        </div>
        <div class="ui-g-12 vt-row">
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
            {{'common.label.partymembersCode' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <input type="text" id="employeeCode"
                               name="employeeCode"
                               formControlName="employeeCode"
                               class="form-control"
                               [autoFocus]="true" >
            <app-control-messages [control]="f['employeeCode']"></app-control-messages>
          </div>
          <label class="ui-g-12 ui-md-6 ui-lg-2 control-label vt-align-right">
            {{'massMember.employeeName' | translate}}
          </label>
          <div class="ui-g-12 ui-md-6 ui-lg-3">
            <input type="text" formControlName="employeeName" class="form-control" >
            <app-control-messages [control]="f['employeeName']"></app-control-messages>
          </div>
        </div>
      </div>
      <div class="panel-footer vt-area-button">
        <button type="submit" class="btn btn-sm btn-info" (click)="processFileSearch()" [innerHTML]="'common.button.icon.search' | translate"></button>
        <button type="button" *ngIf="hasPermission('action.export')" class="btn btn-sm btn-info" (click)="processExportFiles()" [innerHTML]="'common.button.icon.exportFile' | translate"></button>
      </div>
    </form>
    </div>
  </div>
</div>
<div id="listArea">
  <div class="panel panel-default">
    <div class="panel-heading vt-relative">
      <strong class="text-u-c">
        <i class="fa fa-th"></i>
        {{'protectsecurity.mainproject.view.title' | translate}}
      </strong>
    </div>
    <div class="panel-body panel-table">
      <p-table
      #ptable
      [value]="resultList.data"
      [paginator]="true"
      (onLazyLoad)="processFileSearch($event)"
      [lazy]="true" [rows]="changeRow"
      [totalRecords]="resultList.recordsTotal"
      [scrollable]="true"
      [lazyLoadOnInit]="false"
      tableStyleClass="table table-wrapper table-hover table-striped b-t b-b"
      styleClass="controlOverflow">
      <ng-template pTemplate="colgroup" left-columns>
        <colgroup>
          <col class="size-1">
          <col class="size-6">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-8">
          <col class="size-4">
        </colgroup>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th translate>common.table.index</th>
          <th [pSortableColumn]="'employeeCode'" translate>
            common.label.partymembersCode
          <p-sortIcon [field]="'employeeCode'"></p-sortIcon>
          </th>
          <th [pSortableColumn]="'employeeName'" translate>
            massMember.employeeName
            <p-sortIcon [field]="'employeeName'"></p-sortIcon>
          </th>
          <th [pSortableColumn]="'empTypeName'" translate>
            label.document.face
          <p-sortIcon [field]="'empTypeName'"></p-sortIcon>
          </th>
          <th [pSortableColumn]="'positionName'" translate>
            democraticmeeting.label.position
          <p-sortIcon [field]="'positionName'"></p-sortIcon>
          </th>
          <th [pSortableColumn]="'orgFullName'" translate>
            common.label.unit
          <p-sortIcon [field]="'orgFullName'"></p-sortIcon>
          </th>
          <th>{{'generalInformation.label.SecurityCommitment' | translate}}
          </th>
          <th>{{'generalInformation.label.JudicialRecords' | translate}}
          </th>
          <th>{{'generalInformation.label.politicalApprovalForm' | translate}}
          </th>
          <th>{{'generalInformation.label.confirmProfileForm' | translate}}
          </th>
          <th>{{'generalInformation.label.CVForm' | translate}}
          </th>
          <th [pSortableColumn]="'isKeyPosition'" translate>
            protectsecurity.curriculumvitaesecurity.table.vtty
          <p-sortIcon [field]="'isKeyPosition'"></p-sortIcon>

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item let-index="rowIndex+1">
        <tr>
          <td class="vt-align-center">{{index}}</td>
          <td class="vt-align-center">{{item.employeeCode}}</td>
          <td class="vt-align-left">{{item.employeeName}}</td>
          <td class="vt-align-left">{{item.empTypeName}}</td>
          <td class="vt-align-left">{{item.positionName}}</td>
          <td class="vt-align-left">{{item.orgFullName}}</td>
          <td class="vt-align-left"  >
            <a *ngFor="let data of item.fileAttachment.fileInfomationSecurity"
              style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis;
               max-width: 200px; display: block; overflow: hidden"
              (click)="downloadFile(data)">
              - {{data.fileName}}
            </a>
          </td>
          <td class="vt-align-left"  >
            <a *ngFor="let data of item.fileAttachment.fileJudicialRecord"
              style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis;
               max-width: 200px; display: block; overflow: hidden"
              (click)="downloadFile(data)">
              - {{data.fileName}}
            </a>
          </td>
          <td class="vt-align-left"  >
            <a *ngFor="let data of item.fileAttachment.filePoliticalStandard"
              style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis;
               max-width: 200px; display: block; overflow: hidden"
              (click)="downloadFile(data)">
              - {{data.fileName}}
            </a>
          </td>
          <td class="vt-align-left"  >
            <a *ngFor="let data of item.fileAttachment.fileLeaderComment"
              style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis;
               max-width: 200px; display: block; overflow: hidden"
              (click)="downloadFile(data)">
              - {{data.fileName}}
            </a>
          </td>
          <td class="vt-align-left"  >
            <a *ngFor="let data of item.fileAttachment.fileSelfProfile"
              style="color: rgb(0, 153, 255); white-space: nowrap; text-overflow: ellipsis;
               max-width: 200px; display: block; overflow: hidden"
              (click)="downloadFile(data)">
              - {{data.fileName}}
            </a>
          </td>
          <td class="vt-align-center">
            <i *ngIf="item.isKeyPosition==1" class="fas fa-check table-icon color-info"></i>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr class="emptymessage">
          <td [attr.colspan]="14" [innerHTML]="'app.noRecords' | translate">
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="paginatorleft">
        <table-footer (changeRow)="onTablePageChange($event)" [resultList]="resultList"></table-footer>
      </ng-template>
    </p-table>
    </div>
  </div>
</div>